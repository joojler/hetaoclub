/*! * Bootstrap v3.0.3 (http://getbootstrap.com) * Copyright 2013 Twitter, Inc. * Licensed under http://www.apache.org/licenses/LICENSE-2.0 */if("undefined"==typeof jQuery)throw new Error("Bootstrap requires jQuery");+function(a){"use strict";function b(){var a=document.createElement("bootstrap"),b={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var c in b)if(void 0!==a.style[c])return{end:b[c]}}a.fn.emulateTransitionEnd=function(b){var c=!1,d=this;a(this).one(a.support.transition.end,function(){c=!0});var e=function(){c||a(d).trigger(a.support.transition.end)};return setTimeout(e,b),this},a(function(){a.support.transition=b()})}(jQuery),+function(a){"use strict";var b='[data-dismiss="alert"]',c=function(c){a(c).on("click",b,this.close)};c.prototype.close=function(b){function c(){f.trigger("closed.bs.alert").remove()}var d=a(this),e=d.attr("data-target");e||(e=d.attr("href"),e=e&&e.replace(/.*(?=#[^\s]*$)/,""));var f=a(e);b&&b.preventDefault(),f.length||(f=d.hasClass("alert")?d:d.parent()),f.trigger(b=a.Event("close.bs.alert")),b.isDefaultPrevented()||(f.removeClass("in"),a.support.transition&&f.hasClass("fade")?f.one(a.support.transition.end,c).emulateTransitionEnd(150):c())};var d=a.fn.alert;a.fn.alert=function(b){return this.each(function(){var d=a(this),e=d.data("bs.alert");e||d.data("bs.alert",e=new c(this)),"string"==typeof b&&e[b].call(d)})},a.fn.alert.Constructor=c,a.fn.alert.noConflict=function(){return a.fn.alert=d,this},a(document).on("click.bs.alert.data-api",b,c.prototype.close)}(jQuery),+function(a){"use strict";var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d)};b.DEFAULTS={loadingText:"loading..."},b.prototype.setState=function(a){var b="disabled",c=this.$element,d=c.is("input")?"val":"html",e=c.data();a+="Text",e.resetText||c.data("resetText",c[d]()),c[d](e[a]||this.options[a]),setTimeout(function(){"loadingText"==a?c.addClass(b).attr(b,b):c.removeClass(b).removeAttr(b)},0)},b.prototype.toggle=function(){var a=this.$element.closest('[data-toggle="buttons"]'),b=!0;if(a.length){var c=this.$element.find("input");"radio"===c.prop("type")&&(c.prop("checked")&&this.$element.hasClass("active")?b=!1:a.find(".active").removeClass("active")),b&&c.prop("checked",!this.$element.hasClass("active")).trigger("change")}b&&this.$element.toggleClass("active")};var c=a.fn.button;a.fn.button=function(c){return this.each(function(){var d=a(this),e=d.data("bs.button"),f="object"==typeof c&&c;e||d.data("bs.button",e=new b(this,f)),"toggle"==c?e.toggle():c&&e.setState(c)})},a.fn.button.Constructor=b,a.fn.button.noConflict=function(){return a.fn.button=c,this},a(document).on("click.bs.button.data-api","[data-toggle^=button]",function(b){var c=a(b.target);c.hasClass("btn")||(c=c.closest(".btn")),c.button("toggle"),b.preventDefault()})}(jQuery),+function(a){"use strict";var b=function(b,c){this.$element=a(b),this.$indicators=this.$element.find(".carousel-indicators"),this.options=c,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",a.proxy(this.pause,this)).on("mouseleave",a.proxy(this.cycle,this))};b.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},b.prototype.cycle=function(b){return b||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(a.proxy(this.next,this),this.options.interval)),this},b.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},b.prototype.to=function(b){var c=this,d=this.getActiveIndex();return b>this.$items.length-1||0>b?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){c.to(b)}):d==b?this.pause().cycle():this.slide(b>d?"next":"prev",a(this.$items[b]))},b.prototype.pause=function(b){return b||(this.paused=!0),this.$element.find(".next, .prev").length&&a.support.transition.end&&(this.$element.trigger(a.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},b.prototype.next=function(){return this.sliding?void 0:this.slide("next")},b.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},b.prototype.slide=function(b,c){var d=this.$element.find(".item.active"),e=c||d[b](),f=this.interval,g="next"==b?"left":"right",h="next"==b?"first":"last",i=this;if(!e.length){if(!this.options.wrap)return;e=this.$element.find(".item")[h]()}this.sliding=!0,f&&this.pause();var j=a.Event("slide.bs.carousel",{relatedTarget:e[0],direction:g});if(!e.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid.bs.carousel",function(){var b=a(i.$indicators.children()[i.getActiveIndex()]);b&&b.addClass("active")})),a.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(j),j.isDefaultPrevented())return;e.addClass(b),e[0].offsetWidth,d.addClass(g),e.addClass(g),d.one(a.support.transition.end,function(){e.removeClass([b,g].join(" ")).addClass("active"),d.removeClass(["active",g].join(" ")),i.sliding=!1,setTimeout(function(){i.$element.trigger("slid.bs.carousel")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(j),j.isDefaultPrevented())return;d.removeClass("active"),e.addClass("active"),this.sliding=!1,this.$element.trigger("slid.bs.carousel")}return f&&this.cycle(),this}};var c=a.fn.carousel;a.fn.carousel=function(c){return this.each(function(){var d=a(this),e=d.data("bs.carousel"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c),g="string"==typeof c?c:f.slide;e||d.data("bs.carousel",e=new b(this,f)),"number"==typeof c?e.to(c):g?e[g]():f.interval&&e.pause().cycle()})},a.fn.carousel.Constructor=b,a.fn.carousel.noConflict=function(){return a.fn.carousel=c,this},a(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(b){var c,d=a(this),e=a(d.attr("data-target")||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,"")),f=a.extend({},e.data(),d.data()),g=d.attr("data-slide-to");g&&(f.interval=!1),e.carousel(f),(g=d.attr("data-slide-to"))&&e.data("bs.carousel").to(g),b.preventDefault()}),a(window).on("load",function(){a('[data-ride="carousel"]').each(function(){var b=a(this);b.carousel(b.data())})})}(jQuery),+function(a){"use strict";var b=function(c,d){this.$element=a(c),this.options=a.extend({},b.DEFAULTS,d),this.transitioning=null,this.options.parent&&(this.$parent=a(this.options.parent)),this.options.toggle&&this.toggle()};b.DEFAULTS={toggle:!0},b.prototype.dimension=function(){var a=this.$element.hasClass("width");return a?"width":"height"},b.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var b=a.Event("show.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.$parent&&this.$parent.find("> .panel > .in");if(c&&c.length){var d=c.data("bs.collapse");if(d&&d.transitioning)return;c.collapse("hide"),d||c.data("bs.collapse",null)}var e=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[e](0),this.transitioning=1;var f=function(){this.$element.removeClass("collapsing").addClass("in")[e]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!a.support.transition)return f.call(this);var g=a.camelCase(["scroll",e].join("-"));this.$element.one(a.support.transition.end,a.proxy(f,this)).emulateTransitionEnd(350)[e](this.$element[0][g])}}},b.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var b=a.Event("hide.bs.collapse");if(this.$element.trigger(b),!b.isDefaultPrevented()){var c=this.dimension();this.$element[c](this.$element[c]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var d=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return a.support.transition?(this.$element[c](0).one(a.support.transition.end,a.proxy(d,this)).emulateTransitionEnd(350),void 0):d.call(this)}}},b.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var c=a.fn.collapse;a.fn.collapse=function(c){return this.each(function(){var d=a(this),e=d.data("bs.collapse"),f=a.extend({},b.DEFAULTS,d.data(),"object"==typeof c&&c);e||d.data("bs.collapse",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.collapse.Constructor=b,a.fn.collapse.noConflict=function(){return a.fn.collapse=c,this},a(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(b){var c,d=a(this),e=d.attr("data-target")||b.preventDefault()||(c=d.attr("href"))&&c.replace(/.*(?=#[^\s]+$)/,""),f=a(e),g=f.data("bs.collapse"),h=g?"toggle":d.data(),i=d.attr("data-parent"),j=i&&a(i);g&&g.transitioning||(j&&j.find('[data-toggle=collapse][data-parent="'+i+'"]').not(d).addClass("collapsed"),d[f.hasClass("in")?"addClass":"removeClass"]("collapsed")),f.collapse(h)})}(jQuery),+function(a){"use strict";function b(){a(d).remove(),a(e).each(function(b){var d=c(a(this));d.hasClass("open")&&(d.trigger(b=a.Event("hide.bs.dropdown")),b.isDefaultPrevented()||d.removeClass("open").trigger("hidden.bs.dropdown"))})}function c(b){var c=b.attr("data-target");c||(c=b.attr("href"),c=c&&/#/.test(c)&&c.replace(/.*(?=#[^\s]*$)/,""));var d=c&&a(c);return d&&d.length?d:b.parent()}var d=".dropdown-backdrop",e="[data-toggle=dropdown]",f=function(b){a(b).on("click.bs.dropdown",this.toggle)};f.prototype.toggle=function(d){var e=a(this);if(!e.is(".disabled, :disabled")){var f=c(e),g=f.hasClass("open");if(b(),!g){if("ontouchstart"in document.documentElement&&!f.closest(".navbar-nav").length&&a('<div class="dropdown-backdrop"/>').insertAfter(a(this)).on("click",b),f.trigger(d=a.Event("show.bs.dropdown")),d.isDefaultPrevented())return;f.toggleClass("open").trigger("shown.bs.dropdown"),e.focus()}return!1}},f.prototype.keydown=function(b){if(/(38|40|27)/.test(b.keyCode)){var d=a(this);if(b.preventDefault(),b.stopPropagation(),!d.is(".disabled, :disabled")){var f=c(d),g=f.hasClass("open");if(!g||g&&27==b.keyCode)return 27==b.which&&f.find(e).focus(),d.click();var h=a("[role=menu] li:not(.divider):visible a",f);if(h.length){var i=h.index(h.filter(":focus"));38==b.keyCode&&i>0&&i--,40==b.keyCode&&i<h.length-1&&i++,~i||(i=0),h.eq(i).focus()}}}};var g=a.fn.dropdown;a.fn.dropdown=function(b){return this.each(function(){var c=a(this),d=c.data("bs.dropdown");d||c.data("bs.dropdown",d=new f(this)),"string"==typeof b&&d[b].call(c)})},a.fn.dropdown.Constructor=f,a.fn.dropdown.noConflict=function(){return a.fn.dropdown=g,this},a(document).on("click.bs.dropdown.data-api",b).on("click.bs.dropdown.data-api",".dropdown form",function(a){a.stopPropagation()}).on("click.bs.dropdown.data-api",e,f.prototype.toggle).on("keydown.bs.dropdown.data-api",e+", [role=menu]",f.prototype.keydown)}(jQuery),+function(a){"use strict";var b=function(b,c){this.options=c,this.$element=a(b),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};b.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},b.prototype.toggle=function(a){return this[this.isShown?"hide":"show"](a)},b.prototype.show=function(b){var c=this,d=a.Event("show.bs.modal",{relatedTarget:b});this.$element.trigger(d),this.isShown||d.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',a.proxy(this.hide,this)),this.backdrop(function(){var d=a.support.transition&&c.$element.hasClass("fade");c.$element.parent().length||c.$element.appendTo(document.body),c.$element.show(),d&&c.$element[0].offsetWidth,c.$element.addClass("in").attr("aria-hidden",!1),c.enforceFocus();var e=a.Event("shown.bs.modal",{relatedTarget:b});d?c.$element.find(".modal-dialog").one(a.support.transition.end,function(){c.$element.focus().trigger(e)}).emulateTransitionEnd(300):c.$element.focus().trigger(e)}))},b.prototype.hide=function(b){b&&b.preventDefault(),b=a.Event("hide.bs.modal"),this.$element.trigger(b),this.isShown&&!b.isDefaultPrevented()&&(this.isShown=!1,this.escape(),a(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),a.support.transition&&this.$element.hasClass("fade")?this.$element.one(a.support.transition.end,a.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},b.prototype.enforceFocus=function(){a(document).off("focusin.bs.modal").on("focusin.bs.modal",a.proxy(function(a){this.$element[0]===a.target||this.$element.has(a.target).length||this.$element.focus()},this))},b.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",a.proxy(function(a){27==a.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},b.prototype.hideModal=function(){var a=this;this.$element.hide(),this.backdrop(function(){a.removeBackdrop(),a.$element.trigger("hidden.bs.modal")})},b.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},b.prototype.backdrop=function(b){var c=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var d=a.support.transition&&c;if(this.$backdrop=a('<div class="modal-backdrop '+c+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",a.proxy(function(a){a.target===a.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),d&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!b)return;d?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),a.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(a.support.transition.end,b).emulateTransitionEnd(150):b()):b&&b()};var c=a.fn.modal;a.fn.modal=function(c,d){return this.each(function(){var e=a(this),f=e.data("bs.modal"),g=a.extend({},b.DEFAULTS,e.data(),"object"==typeof c&&c);f||e.data("bs.modal",f=new b(this,g)),"string"==typeof c?f[c](d):g.show&&f.show(d)})},a.fn.modal.Constructor=b,a.fn.modal.noConflict=function(){return a.fn.modal=c,this},a(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(b){var c=a(this),d=c.attr("href"),e=a(c.attr("data-target")||d&&d.replace(/.*(?=#[^\s]+$)/,"")),f=e.data("modal")?"toggle":a.extend({remote:!/#/.test(d)&&d},e.data(),c.data());b.preventDefault(),e.modal(f,this).one("hide",function(){c.is(":visible")&&c.focus()})}),a(document).on("show.bs.modal",".modal",function(){a(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){a(document.body).removeClass("modal-open")})}(jQuery),+function(a){"use strict";var b=function(a,b){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",a,b)};b.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},b.prototype.init=function(b,c,d){this.enabled=!0,this.type=b,this.$element=a(c),this.options=this.getOptions(d);for(var e=this.options.trigger.split(" "),f=e.length;f--;){var g=e[f];if("click"==g)this.$element.on("click."+this.type,this.options.selector,a.proxy(this.toggle,this));else if("manual"!=g){var h="hover"==g?"mouseenter":"focus",i="hover"==g?"mouseleave":"blur";this.$element.on(h+"."+this.type,this.options.selector,a.proxy(this.enter,this)),this.$element.on(i+"."+this.type,this.options.selector,a.proxy(this.leave,this))}}this.options.selector?this._options=a.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},b.prototype.getDefaults=function(){return b.DEFAULTS},b.prototype.getOptions=function(b){return b=a.extend({},this.getDefaults(),this.$element.data(),b),b.delay&&"number"==typeof b.delay&&(b.delay={show:b.delay,hide:b.delay}),b},b.prototype.getDelegateOptions=function(){var b={},c=this.getDefaults();return this._options&&a.each(this._options,function(a,d){c[a]!=d&&(b[a]=d)}),b},b.prototype.enter=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.hoverState="in",c.options.delay&&c.options.delay.show?(c.timeout=setTimeout(function(){"in"==c.hoverState&&c.show()},c.options.delay.show),void 0):c.show()},b.prototype.leave=function(b){var c=b instanceof this.constructor?b:a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(c.timeout),c.hoverState="out",c.options.delay&&c.options.delay.hide?(c.timeout=setTimeout(function(){"out"==c.hoverState&&c.hide()},c.options.delay.hide),void 0):c.hide()},b.prototype.show=function(){var b=a.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(b),b.isDefaultPrevented())return;var c=this.tip();this.setContent(),this.options.animation&&c.addClass("fade");var d="function"==typeof this.options.placement?this.options.placement.call(this,c[0],this.$element[0]):this.options.placement,e=/\s?auto?\s?/i,f=e.test(d);f&&(d=d.replace(e,"")||"top"),c.detach().css({top:0,left:0,display:"block"}).addClass(d),this.options.container?c.appendTo(this.options.container):c.insertAfter(this.$element);var g=this.getPosition(),h=c[0].offsetWidth,i=c[0].offsetHeight;if(f){var j=this.$element.parent(),k=d,l=document.documentElement.scrollTop||document.body.scrollTop,m="body"==this.options.container?window.innerWidth:j.outerWidth(),n="body"==this.options.container?window.innerHeight:j.outerHeight(),o="body"==this.options.container?0:j.offset().left;d="bottom"==d&&g.top+g.height+i-l>n?"top":"top"==d&&g.top-l-i<0?"bottom":"right"==d&&g.right+h>m?"left":"left"==d&&g.left-h<o?"right":d,c.removeClass(k).addClass(d)}var p=this.getCalculatedOffset(d,g,h,i);this.applyPlacement(p,d),this.$element.trigger("shown.bs."+this.type)}},b.prototype.applyPlacement=function(a,b){var c,d=this.tip(),e=d[0].offsetWidth,f=d[0].offsetHeight,g=parseInt(d.css("margin-top"),10),h=parseInt(d.css("margin-left"),10);isNaN(g)&&(g=0),isNaN(h)&&(h=0),a.top=a.top+g,a.left=a.left+h,d.offset(a).addClass("in");var i=d[0].offsetWidth,j=d[0].offsetHeight;if("top"==b&&j!=f&&(c=!0,a.top=a.top+f-j),/bottom|top/.test(b)){var k=0;a.left<0&&(k=-2*a.left,a.left=0,d.offset(a),i=d[0].offsetWidth,j=d[0].offsetHeight),this.replaceArrow(k-e+i,i,"left")}else this.replaceArrow(j-f,j,"top");c&&d.offset(a)},b.prototype.replaceArrow=function(a,b,c){this.arrow().css(c,a?50*(1-a/b)+"%":"")},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle();a.find(".tooltip-inner")[this.options.html?"html":"text"](b),a.removeClass("fade in top bottom left right")},b.prototype.hide=function(){function b(){"in"!=c.hoverState&&d.detach()}var c=this,d=this.tip(),e=a.Event("hide.bs."+this.type);return this.$element.trigger(e),e.isDefaultPrevented()?void 0:(d.removeClass("in"),a.support.transition&&this.$tip.hasClass("fade")?d.one(a.support.transition.end,b).emulateTransitionEnd(150):b(),this.$element.trigger("hidden.bs."+this.type),this)},b.prototype.fixTitle=function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("data-original-title"))&&a.attr("data-original-title",a.attr("title")||"").attr("title","")},b.prototype.hasContent=function(){return this.getTitle()},b.prototype.getPosition=function(){var b=this.$element[0];return a.extend({},"function"==typeof b.getBoundingClientRect?b.getBoundingClientRect():{width:b.offsetWidth,height:b.offsetHeight},this.$element.offset())},b.prototype.getCalculatedOffset=function(a,b,c,d){return"bottom"==a?{top:b.top+b.height,left:b.left+b.width/2-c/2}:"top"==a?{top:b.top-d,left:b.left+b.width/2-c/2}:"left"==a?{top:b.top+b.height/2-d/2,left:b.left-c}:{top:b.top+b.height/2-d/2,left:b.left+b.width}},b.prototype.getTitle=function(){var a,b=this.$element,c=this.options;return a=b.attr("data-original-title")||("function"==typeof c.title?c.title.call(b[0]):c.title)},b.prototype.tip=function(){return this.$tip=this.$tip||a(this.options.template)},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},b.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},b.prototype.enable=function(){this.enabled=!0},b.prototype.disable=function(){this.enabled=!1},b.prototype.toggleEnabled=function(){this.enabled=!this.enabled},b.prototype.toggle=function(b){var c=b?a(b.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;c.tip().hasClass("in")?c.leave(c):c.enter(c)},b.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var c=a.fn.tooltip;a.fn.tooltip=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tooltip"),f="object"==typeof c&&c;e||d.data("bs.tooltip",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.tooltip.Constructor=b,a.fn.tooltip.noConflict=function(){return a.fn.tooltip=c,this}}(jQuery),+function(a){"use strict";var b=function(a,b){this.init("popover",a,b)};if(!a.fn.tooltip)throw new Error("Popover requires tooltip.js");b.DEFAULTS=a.extend({},a.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),b.prototype=a.extend({},a.fn.tooltip.Constructor.prototype),b.prototype.constructor=b,b.prototype.getDefaults=function(){return b.DEFAULTS},b.prototype.setContent=function(){var a=this.tip(),b=this.getTitle(),c=this.getContent();a.find(".popover-title")[this.options.html?"html":"text"](b),a.find(".popover-content")[this.options.html?"html":"text"](c),a.removeClass("fade top bottom left right in"),a.find(".popover-title").html()||a.find(".popover-title").hide()},b.prototype.hasContent=function(){return this.getTitle()||this.getContent()},b.prototype.getContent=function(){var a=this.$element,b=this.options;return a.attr("data-content")||("function"==typeof b.content?b.content.call(a[0]):b.content)},b.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},b.prototype.tip=function(){return this.$tip||(this.$tip=a(this.options.template)),this.$tip};var c=a.fn.popover;a.fn.popover=function(c){return this.each(function(){var d=a(this),e=d.data("bs.popover"),f="object"==typeof c&&c;e||d.data("bs.popover",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.popover.Constructor=b,a.fn.popover.noConflict=function(){return a.fn.popover=c,this}}(jQuery),+function(a){"use strict";function b(c,d){var e,f=a.proxy(this.process,this);this.$element=a(c).is("body")?a(window):a(c),this.$body=a("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",f),this.options=a.extend({},b.DEFAULTS,d),this.selector=(this.options.target||(e=a(c).attr("href"))&&e.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=a([]),this.targets=a([]),this.activeTarget=null,this.refresh(),this.process()}b.DEFAULTS={offset:10},b.prototype.refresh=function(){var b=this.$element[0]==window?"offset":"position";this.offsets=a([]),this.targets=a([]);var c=this;this.$body.find(this.selector).map(function(){var d=a(this),e=d.data("target")||d.attr("href"),f=/^#\w/.test(e)&&a(e);return f&&f.length&&[[f[b]().top+(!a.isWindow(c.$scrollElement.get(0))&&c.$scrollElement.scrollTop()),e]]||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){c.offsets.push(this[0]),c.targets.push(this[1])})},b.prototype.process=function(){var a,b=this.$scrollElement.scrollTop()+this.options.offset,c=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,d=c-this.$scrollElement.height(),e=this.offsets,f=this.targets,g=this.activeTarget;if(b>=d)return g!=(a=f.last()[0])&&this.activate(a);for(a=e.length;a--;)g!=f[a]&&b>=e[a]&&(!e[a+1]||b<=e[a+1])&&this.activate(f[a])},b.prototype.activate=function(b){this.activeTarget=b,a(this.selector).parents(".active").removeClass("active");var c=this.selector+'[data-target="'+b+'"],'+this.selector+'[href="'+b+'"]',d=a(c).parents("li").addClass("active");d.parent(".dropdown-menu").length&&(d=d.closest("li.dropdown").addClass("active")),d.trigger("activate.bs.scrollspy")};var c=a.fn.scrollspy;a.fn.scrollspy=function(c){return this.each(function(){var d=a(this),e=d.data("bs.scrollspy"),f="object"==typeof c&&c;e||d.data("bs.scrollspy",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.scrollspy.Constructor=b,a.fn.scrollspy.noConflict=function(){return a.fn.scrollspy=c,this},a(window).on("load",function(){a('[data-spy="scroll"]').each(function(){var b=a(this);b.scrollspy(b.data())})})}(jQuery),+function(a){"use strict";var b=function(b){this.element=a(b)};b.prototype.show=function(){var b=this.element,c=b.closest("ul:not(.dropdown-menu)"),d=b.data("target");if(d||(d=b.attr("href"),d=d&&d.replace(/.*(?=#[^\s]*$)/,"")),!b.parent("li").hasClass("active")){var e=c.find(".active:last a")[0],f=a.Event("show.bs.tab",{relatedTarget:e});if(b.trigger(f),!f.isDefaultPrevented()){var g=a(d);this.activate(b.parent("li"),c),this.activate(g,g.parent(),function(){b.trigger({type:"shown.bs.tab",relatedTarget:e})})}}},b.prototype.activate=function(b,c,d){function e(){f.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),b.addClass("active"),g?(b[0].offsetWidth,b.addClass("in")):b.removeClass("fade"),b.parent(".dropdown-menu")&&b.closest("li.dropdown").addClass("active"),d&&d()}var f=c.find("> .active"),g=d&&a.support.transition&&f.hasClass("fade");g?f.one(a.support.transition.end,e).emulateTransitionEnd(150):e(),f.removeClass("in")};var c=a.fn.tab;a.fn.tab=function(c){return this.each(function(){var d=a(this),e=d.data("bs.tab");e||d.data("bs.tab",e=new b(this)),"string"==typeof c&&e[c]()})},a.fn.tab.Constructor=b,a.fn.tab.noConflict=function(){return a.fn.tab=c,this},a(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(b){b.preventDefault(),a(this).tab("show")})}(jQuery),+function(a){"use strict";var b=function(c,d){this.options=a.extend({},b.DEFAULTS,d),this.$window=a(window).on("scroll.bs.affix.data-api",a.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",a.proxy(this.checkPositionWithEventLoop,this)),this.$element=a(c),this.affixed=this.unpin=null,this.checkPosition()};b.RESET="affix affix-top affix-bottom",b.DEFAULTS={offset:0},b.prototype.checkPositionWithEventLoop=function(){setTimeout(a.proxy(this.checkPosition,this),1)},b.prototype.checkPosition=function(){if(this.$element.is(":visible")){var c=a(document).height(),d=this.$window.scrollTop(),e=this.$element.offset(),f=this.options.offset,g=f.top,h=f.bottom;"object"!=typeof f&&(h=g=f),"function"==typeof g&&(g=f.top()),"function"==typeof h&&(h=f.bottom());var i=null!=this.unpin&&d+this.unpin<=e.top?!1:null!=h&&e.top+this.$element.height()>=c-h?"bottom":null!=g&&g>=d?"top":!1;this.affixed!==i&&(this.unpin&&this.$element.css("top",""),this.affixed=i,this.unpin="bottom"==i?e.top-d:null,this.$element.removeClass(b.RESET).addClass("affix"+(i?"-"+i:"")),"bottom"==i&&this.$element.offset({top:document.body.offsetHeight-h-this.$element.height()}))}};var c=a.fn.affix;a.fn.affix=function(c){return this.each(function(){var d=a(this),e=d.data("bs.affix"),f="object"==typeof c&&c;e||d.data("bs.affix",e=new b(this,f)),"string"==typeof c&&e[c]()})},a.fn.affix.Constructor=b,a.fn.affix.noConflict=function(){return a.fn.affix=c,this},a(window).on("load",function(){a('[data-spy="affix"]').each(function(){var b=a(this),c=b.data();c.offset=c.offset||{},c.offsetBottom&&(c.offset.bottom=c.offsetBottom),c.offsetTop&&(c.offset.top=c.offsetTop),b.affix(c)})})}(jQuery);// Hoganvar Hogan={};(function(g,v){function u(a){return String(null===a||void 0===a?"":a)}g.Template=function(a,b,f,c){this.r=a||this.r;this.c=f;this.options=c;this.text=b||"";this.buf=v?[]:""};g.Template.prototype={r:function(){return""},v:function(a){a=u(a);return y.test(a)?a.replace(x,"&amp;").replace(n,"&lt;").replace(q,"&gt;").replace(t,"&#39;").replace(z,"&quot;"):a},t:u,render:function(a,b,f){return this.ri([a],b||{},f)},ri:function(a,b,f){return this.r(a,b,f)},rp:function(a,b,f,c){a=f[a];if(!a)return"";this.c&&"string"==typeof a&&(a=this.c.compile(a,this.options));return a.ri(b,f,c)},rs:function(a,b,f){var c=a[a.length-1];if(w(c))for(var h=0;h<c.length;h++)a.push(c[h]),f(a,b,this),a.pop();else f(a,b,this)},s:function(a,b,f,c,h,d,m){if(w(a)&&0===a.length)return!1;"function"==typeof a&&(a=this.ls(a,b,f,c,h,d,m));f=""===a||!!a;!c&&(f&&b)&&b.push("object"==typeof a?a:b[b.length-1]);return f},d:function(a,b,f,c){var h=a.split("."),d=this.f(h[0],b,f,c),m=null;if("."===a&&w(b[b.length-2]))return b[b.length-1];for(a=1;a<h.length;a++)d&&"object"==typeof d&&h[a]in d?(m=d,d=d[h[a]]):d="";if(c&&!d)return!1;!c&&"function"==typeof d&&(b.push(m),d=this.lv(d,b,f),b.pop());return d},f:function(a,b,f,c){for(var h=!1,d=null,m=!1,e=b.length-1;0<=e;e--)if((d=b[e])&&"object"==typeof d&&a in d){h=d[a];m=!0;break}if(!m)return c?!1:"";!c&&"function"==typeof h&&(h=this.lv(h,b,f));return h},ho:function(a,b,f,c,h){var d=this.c,m=this.options;m.delimiters=h;c=a.call(b,c);c=null==c?String(c):c.toString();this.b(d.compile(c,m).render(b,f));return!1},b:v?function(a){this.buf.push(a)}:function(a){this.buf+=a},fl:v?function(){var a=this.buf.join("");this.buf=[];return a}:function(){var a=this.buf;this.buf="";return a},ls:function(a,b,f,c,h,d,m){b=b[b.length-1];var e=null;if(!c&&this.c&&0<a.length)return this.ho(a,b,f,this.text.substring(h,d),m);e=a.call(b);if("function"==typeof e){if(c)return!0;if(this.c)return this.ho(e,b,f,this.text.substring(h,d),m)}return e},lv:function(a,b,f){b=b[b.length-1];a=a.call(b);return"function"==typeof a&&(a=u(a.call(b)),this.c&&~a.indexOf("{{"))?this.c.compile(a,this.options).render(b,f):u(a)}};var x=/&/g,n=/</g,q=/>/g,t=/\'/g,z=/\"/g,y=/[&<>\"\']/,w=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}})("undefined"!==typeof exports?exports:Hogan);(function(g){function v(c){return c.trim?c.trim():c.replace(/^\s*|\s*$/g,"")}function u(c,a,d){if(a.charAt(d)!=c.charAt(0))return!1;for(var b=1,e=c.length;b<e;b++)if(a.charAt(d+b)!=c.charAt(b))return!1;return!0}function x(c,a,d,b){a=[];for(var e=null,f=null;0<c.length;){f=c.shift();if(!(e="#"==f.tag))if(!(e="^"==f.tag))a:{for(var e=f,g=b,k=0,p=g.length;k<p;k++)if(g[k].o==e.n){e.tag="#";e=!0;break a}e=void 0}if(e)d.push(f),f.nodes=x(c,f.tag,d,b);else if("/"==f.tag){if(0===d.length)throw Error("Closing tag without opener: /"+f.n);e=d.pop();if(c=f.n!=e.n){a:{c=0;for(d=b.length;c<d;c++)if(b[c].c==f.n&&b[c].o==e.n){b=!0;break a}b=void 0}c=!b}if(c)throw Error("Nesting error: "+e.n+" vs. "+f.n);e.end=f.i;return a}a.push(f)}if(0<d.length)throw Error("missing closing tag: "+d.pop().n);return a}function n(c){return c.replace(b,"\\\\").replace(y,'\\"').replace(w,"\\n").replace(a,"\\r")}function q(c){return~c.indexOf(".")?"d":"f"}function t(c){for(var a="",d=0,b=c.length;d<b;d++){var e=c[d].tag;if("#"==e)var e=c[d].nodes,f=q(c[d].n),g=c[d].i,k=c[d].end,p=c[d].otag+" "+c[d].ctag,e="if(_.s(_."+f+'("'+n(c[d].n)+'",c,p,1),c,p,0,'+g+","+k+',"'+p+'")){_.rs(c,p,function(c,p,_){'+t(e)+"});c.pop();}",a=a+e;else"^"==e?(e=c[d].nodes,e="if(!_.s(_."+q(c[d].n)+'("'+n(c[d].n)+'",c,p,1),c,p,1,0,0,"")){'+t(e)+"};",a+=e):"<"==e||">"==e?a+='_.b(_.rp("'+n(c[d].n)+'",c,p,"'+(c[d].indent||"")+'"));':"{"==e||"&"==e?(e="_.b(_.t(_."+q(c[d].n)+'("'+n(c[d].n)+'",c,p,0)));',a+=e):"\n"==e?a+='_.b("\\n"'+(c.length-1==d?"":" + i")+");":"_v"==e?(e="_.b(_.v(_."+q(c[d].n)+'("'+n(c[d].n)+'",c,p,0)));',a+=e):void 0===e&&(e='"'+n(c[d])+'"',a+="_.b("+e+");")}return a}var z=/\S/,y=/\"/g,w=/\n/g,a=/\r/g,b=/\\/g,f={"#":1,"^":2,"/":3,"!":4,">":5,"<":6,"=":7,_v:8,"{":9,"&":10};g.scan=function(a,b){function d(){0<p.length&&(l.push(new String(p)),p="")}function m(a,c){d();var b;if(b=a)a:{b=!0;for(var e=t;e<l.length;e++)if(b=l[e].tag&&f[l[e].tag]<f._v||!l[e].tag&&null===l[e].match(z),!b){b=!1;break a}}if(b){b=t;for(var h;b<l.length;b++)if(!l[b].tag){if((h=l[b+1])&&">"==h.tag)h.indent=l[b].toString();l.splice(b,1)}}else c||l.push({tag:"\n"});q=!1;t=l.length}var e=a.length,g=0,n=null,k=null,p="",l=[],q=!1,j=0,t=0,s="{{",r="}}";b&&(b=b.split(" "),s=b[0],r=b[1]);for(j=0;j<e;j++)0==g?u(s,a,j)?(--j,d(),g=1):"\n"==a.charAt(j)?m(q):p+=a.charAt(j):1==g?(j+=s.length-1,n=(k=f[a.charAt(j+1)])?a.charAt(j+1):"_v","="==n?(s=a,k=j,j="="+r,g=s.indexOf(j,k),r=v(s.substring(s.indexOf("=",k)+1,g)).split(" "),s=r[0],r=r[1],j=g+j.length-1,g=0):(k&&j++,g=2),q=j):u(r,a,j)?(l.push({tag:n,n:v(p),otag:s,ctag:r,i:"/"==n?q-r.length:j+s.length}),p="",j+=r.length-1,g=0,"{"==n&&("}}"==r?j++:(k=l[l.length-1],"}"===k.n.substr(k.n.length-1)&&(k.n=k.n.substring(0,k.n.length-1))))):p+=a.charAt(j);m(q,!0);return l};g.generate=function(a,b,d){a='var _=this;_.b(i=i||"");'+t(a)+"return _.fl();";return d.asString?"function(c,p,i){"+a+";}":new g.Template(new Function("c","p","i",a),b,g,d)};g.parse=function(a,b,d){d=d||{};return x(a,"",[],d.sectionTags||[])};g.cache={};g.compile=function(a,b){b=b||{};var d=a+"||"+!!b.asString,f=this.cache[d];if(f)return f;f=this.generate(this.parse(this.scan(a,b.delimiters),a,b),a,b);return this.cache[d]=f}})("undefined"!==typeof exports?exports:Hogan);// jQuery.ScrollTo(function(d){function h(b){return"object"==typeof b?b:{top:b,left:b}}var l=d.scrollTo=function(b,c,a){d(window).scrollTo(b,c,a)};l.defaults={axis:"xy",duration:1.3<=parseFloat(d.fn.jquery)?0:1,limit:!0};l.window=function(){return d(window)._scrollable()};d.fn._scrollable=function(){return this.map(function(){if(this.nodeName&&-1==d.inArray(this.nodeName.toLowerCase(),["iframe","#document","html","body"]))return this;var b=(this.contentWindow||this).document||this.ownerDocument||this;return/webkit/i.test(navigator.userAgent)||"BackCompat"==b.compatMode?b.body:b.documentElement})};d.fn.scrollTo=function(b,c,a){"object"==typeof c&&(a=c,c=0);"function"==typeof a&&(a={onAfter:a});"max"==b&&(b=9E9);a=d.extend({},l.defaults,a);c=c||a.duration;a.queue=a.queue&&1<a.axis.length;a.queue&&(c/=2);a.offset=h(a.offset);a.over=h(a.over);return this._scrollable().each(function(){function n(e){i.animate(f,c,a.easing,e&&function(){e.call(this,b,a)})}if(b){var j=this,i=d(j),e=b,m,f={},p=i.is("html,body");switch(typeof e){case "number":case "string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(e)){e=h(e);break}e=d(e,this);if(!e.length)return;case "object":if(e.is||e.style)m=(e=d(e)).offset()}d.each(a.axis.split(""),function(b,d){var c=d=="x"?"Left":"Top",k=c.toLowerCase(),g="scroll"+c,h=j[g],o=l.max(j,d);if(m){f[g]=m[k]+(p?0:h-i.offset()[k]);if(a.margin){f[g]=f[g]-(parseInt(e.css("margin"+c))||0);f[g]=f[g]-(parseInt(e.css("border"+c+"Width"))||0)}f[g]=f[g]+(a.offset[k]||0);a.over[k]&&(f[g]=f[g]+e[d=="x"?"width":"height"]()*a.over[k])}else{c=e[k];f[g]=c.slice&&c.slice(-1)=="%"?parseFloat(c)/100*o:c}a.limit&&/^\d+$/.test(f[g])&&(f[g]=f[g]<=0?0:Math.min(f[g],o));if(!b&&a.queue){h!=f[g]&&n(a.onAfterFirst);delete f[g]}});n(a.onAfter)}}).end()};l.max=function(b,c){var a="x"==c?"Width":"Height",h="scroll"+a;if(!d(b).is("html,body"))return b[h]-d(b)[a.toLowerCase()]();var a="client"+a,j=b.ownerDocument.documentElement,i=b.ownerDocument.body;return Math.max(j[h],i[h])-Math.min(j[a],i[a])}})(jQuery);/*!	Autosize v1.18.4 - 2014-01-11	Automatically adjust textarea height based on user input.	(c) 2014 Jack Moore - http://www.jacklmoore.com/autosize	license: http://www.opensource.org/licenses/mit-license.php*/!function(a){var b,c={className:"autosizejs",append:"",callback:!1,resizeDelay:10,placeholder:!0},d='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; padding: 0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',e=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],f=a(d).data("autosize",!0)[0];f.style.lineHeight="99px","99px"===a(f).css("lineHeight")&&e.push("lineHeight"),f.style.lineHeight="",a.fn.autosize=function(d){return this.length?(d=a.extend({},c,d||{}),f.parentNode!==document.body&&a(document.body).append(f),this.each(function(){function c(){var b,c=window.getComputedStyle?window.getComputedStyle(m,null):!1;c?(b=m.getBoundingClientRect().width,0===b&&(b=parseInt(c.width,10)),a.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(a,d){b-=parseInt(c[d],10)})):b=Math.max(n.width(),0),f.style.width=b+"px"}function g(){var g={};if(b=m,f.className=d.className,j=parseInt(n.css("maxHeight"),10),a.each(e,function(a,b){g[b]=n.css(b)}),a(f).css(g),c(),window.chrome){var h=m.style.width;m.style.width="0px";{m.offsetWidth}m.style.width=h}}function h(){var e,h;b!==m?g():c(),f.value=!m.value&&d.placeholder?(a(m).attr("placeholder")||"")+d.append:m.value+d.append,f.style.overflowY=m.style.overflowY,h=parseInt(m.style.height,10),f.scrollTop=0,f.scrollTop=9e4,e=f.scrollTop,j&&e>j?(m.style.overflowY="scroll",e=j):(m.style.overflowY="hidden",k>e&&(e=k)),e+=o,h!==e&&(m.style.height=e+"px",p&&d.callback.call(m,m))}function i(){clearTimeout(l),l=setTimeout(function(){var a=n.width();a!==r&&(r=a,h())},parseInt(d.resizeDelay,10))}var j,k,l,m=this,n=a(m),o=0,p=a.isFunction(d.callback),q={height:m.style.height,overflow:m.style.overflow,overflowY:m.style.overflowY,wordWrap:m.style.wordWrap,resize:m.style.resize},r=n.width();n.data("autosize")||(n.data("autosize",!0),("border-box"===n.css("box-sizing")||"border-box"===n.css("-moz-box-sizing")||"border-box"===n.css("-webkit-box-sizing"))&&(o=n.outerHeight()-n.height()),k=Math.max(parseInt(n.css("minHeight"),10)-o||0,n.height()),n.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word",resize:"none"===n.css("resize")||"vertical"===n.css("resize")?"none":"horizontal"}),"onpropertychange"in m?"oninput"in m?n.on("input.autosize keyup.autosize",h):n.on("propertychange.autosize",function(){"value"===event.propertyName&&h()}):n.on("input.autosize",h),d.resizeDelay!==!1&&a(window).on("resize.autosize",i),n.on("autosize.resize",h),n.on("autosize.resizeIncludeStyle",function(){b=null,h()}),n.on("autosize.destroy",function(){b=null,clearTimeout(l),a(window).off("resize",i),n.off("autosize").off(".autosize").css(q).removeData("autosize")}),h())})):this}}(window.jQuery||window.$);/*! fancyBox v2.1.5 fancyapps.com | fancyapps.com/fancybox/#license */(function(r,G,f,v){var J=f("html"),n=f(r),p=f(G),b=f.fancybox=function(){b.open.apply(this,arguments)},I=navigator.userAgent.match(/msie/i),B=null,s=G.createTouch!==v,t=function(a){return a&&a.hasOwnProperty&&a instanceof f},q=function(a){return a&&"string"===f.type(a)},E=function(a){return q(a)&&0<a.indexOf("%")},l=function(a,d){var e=parseInt(a,10)||0;d&&E(a)&&(e*=b.getViewport()[d]/100);return Math.ceil(e)},w=function(a,b){return l(a,b)+"px"};f.extend(b,{version:"2.1.5",defaults:{padding:15,margin:20,width:800,height:600,minWidth:100,minHeight:100,maxWidth:9999,maxHeight:9999,pixelRatio:1,autoSize:!0,autoHeight:!1,autoWidth:!1,autoResize:!0,autoCenter:!s,fitToView:!0,aspectRatio:!1,topRatio:0.5,leftRatio:0.5,scrolling:"auto",wrapCSS:"",arrows:!0,closeBtn:!0,closeClick:!1,nextClick:!1,mouseWheel:!0,autoPlay:!1,playSpeed:3E3,preload:3,modal:!1,loop:!0,ajax:{dataType:"html",headers:{"X-fancyBox":!0}},iframe:{scrolling:"auto",preload:!0},swf:{wmode:"transparent",allowfullscreen:"true",allowscriptaccess:"always"},keys:{next:{13:"left",34:"up",39:"left",40:"up"},prev:{8:"right",33:"down",37:"right",38:"down"},close:[27],play:[32],toggle:[70]},direction:{next:"left",prev:"right"},scrollOutside:!0,index:0,type:null,href:null,content:null,title:null,tpl:{wrap:'<div class="fancybox-wrap" tabIndex="-1"><div class="fancybox-skin"><div class="fancybox-outer"><div class="fancybox-inner"></div></div></div></div>',image:'<img class="fancybox-image" src="{href}" alt="" />',iframe:'<iframe id="fancybox-frame{rnd}" name="fancybox-frame{rnd}" class="fancybox-iframe" frameborder="0" vspace="0" hspace="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen'+(I?' allowtransparency="true"':"")+"></iframe>",error:'<p class="fancybox-error">The requested content cannot be loaded.<br/>Please try again later.</p>',closeBtn:'<a title="Close" class="fancybox-item fancybox-close" href="javascript:;"></a>',next:'<a title="Next" class="fancybox-nav fancybox-next" href="javascript:;"><span></span></a>',prev:'<a title="Previous" class="fancybox-nav fancybox-prev" href="javascript:;"><span></span></a>'},openEffect:"fade",openSpeed:250,openEasing:"swing",openOpacity:!0,openMethod:"zoomIn",closeEffect:"fade",closeSpeed:250,closeEasing:"swing",closeOpacity:!0,closeMethod:"zoomOut",nextEffect:"elastic",nextSpeed:250,nextEasing:"swing",nextMethod:"changeIn",prevEffect:"elastic",prevSpeed:250,prevEasing:"swing",prevMethod:"changeOut",helpers:{overlay:!0,title:!0},onCancel:f.noop,beforeLoad:f.noop,afterLoad:f.noop,beforeShow:f.noop,afterShow:f.noop,beforeChange:f.noop,beforeClose:f.noop,afterClose:f.noop},group:{},opts:{},previous:null,coming:null,current:null,isActive:!1,isOpen:!1,isOpened:!1,wrap:null,skin:null,outer:null,inner:null,player:{timer:null,isActive:!1},ajaxLoad:null,imgPreload:null,transitions:{},helpers:{},open:function(a,d){if(a&&(f.isPlainObject(d)||(d={}),!1!==b.close(!0)))return f.isArray(a)||(a=t(a)?f(a).get():[a]),f.each(a,function(e,c){var k={},g,h,j,m,l;"object"===f.type(c)&&(c.nodeType&&(c=f(c)),t(c)?(k={href:c.data("fancybox-href")||c.attr("href"),title:c.data("fancybox-title")||c.attr("title"),isDom:!0,element:c},f.metadata&&f.extend(!0,k,c.metadata())):k=c);g=d.href||k.href||(q(c)?c:null);h=d.title!==v?d.title:k.title||"";m=(j=d.content||k.content)?"html":d.type||k.type;!m&&k.isDom&&(m=c.data("fancybox-type"),m||(m=(m=c.prop("class").match(/fancybox\.(\w+)/))?m[1]:null));q(g)&&(m||(b.isImage(g)?m="image":b.isSWF(g)?m="swf":"#"===g.charAt(0)?m="inline":q(c)&&(m="html",j=c)),"ajax"===m&&(l=g.split(/\s+/,2),g=l.shift(),l=l.shift()));j||("inline"===m?g?j=f(q(g)?g.replace(/.*(?=#[^\s]+$)/,""):g):k.isDom&&(j=c):"html"===m?j=g:!m&&(!g&&k.isDom)&&(m="inline",j=c));f.extend(k,{href:g,type:m,content:j,title:h,selector:l});a[e]=k}),b.opts=f.extend(!0,{},b.defaults,d),d.keys!==v&&(b.opts.keys=d.keys?f.extend({},b.defaults.keys,d.keys):!1),b.group=a,b._start(b.opts.index)},cancel:function(){var a=b.coming;a&&!1!==b.trigger("onCancel")&&(b.hideLoading(),b.ajaxLoad&&b.ajaxLoad.abort(),b.ajaxLoad=null,b.imgPreload&&(b.imgPreload.onload=b.imgPreload.onerror=null),a.wrap&&a.wrap.stop(!0,!0).trigger("onReset").remove(),b.coming=null,b.current||b._afterZoomOut(a))},close:function(a){b.cancel();!1!==b.trigger("beforeClose")&&(b.unbindEvents(),b.isActive&&(!b.isOpen||!0===a?(f(".fancybox-wrap").stop(!0).trigger("onReset").remove(),b._afterZoomOut()):(b.isOpen=b.isOpened=!1,b.isClosing=!0,f(".fancybox-item, .fancybox-nav").remove(),b.wrap.stop(!0,!0).removeClass("fancybox-opened"),b.transitions[b.current.closeMethod]())))},play:function(a){var d=function(){clearTimeout(b.player.timer)},e=function(){d();b.current&&b.player.isActive&&(b.player.timer=setTimeout(b.next,b.current.playSpeed))},c=function(){d();p.unbind(".player");b.player.isActive=!1;b.trigger("onPlayEnd")};if(!0===a||!b.player.isActive&&!1!==a){if(b.current&&(b.current.loop||b.current.index<b.group.length-1))b.player.isActive=!0,p.bind({"onCancel.player beforeClose.player":c,"onUpdate.player":e,"beforeLoad.player":d}),e(),b.trigger("onPlayStart")}else c()},next:function(a){var d=b.current;d&&(q(a)||(a=d.direction.next),b.jumpto(d.index+1,a,"next"))},prev:function(a){var d=b.current;d&&(q(a)||(a=d.direction.prev),b.jumpto(d.index-1,a,"prev"))},jumpto:function(a,d,e){var c=b.current;c&&(a=l(a),b.direction=d||c.direction[a>=c.index?"next":"prev"],b.router=e||"jumpto",c.loop&&(0>a&&(a=c.group.length+a%c.group.length),a%=c.group.length),c.group[a]!==v&&(b.cancel(),b._start(a)))},reposition:function(a,d){var e=b.current,c=e?e.wrap:null,k;c&&(k=b._getPosition(d),a&&"scroll"===a.type?(delete k.position,c.stop(!0,!0).animate(k,200)):(c.css(k),e.pos=f.extend({},e.dim,k)))},update:function(a){var d=a&&a.type,e=!d||"orientationchange"===d;e&&(clearTimeout(B),B=null);b.isOpen&&!B&&(B=setTimeout(function(){var c=b.current;c&&!b.isClosing&&(b.wrap.removeClass("fancybox-tmp"),(e||"load"===d||"resize"===d&&c.autoResize)&&b._setDimension(),"scroll"===d&&c.canShrink||b.reposition(a),b.trigger("onUpdate"),B=null)},e&&!s?0:300))},toggle:function(a){b.isOpen&&(b.current.fitToView="boolean"===f.type(a)?a:!b.current.fitToView,s&&(b.wrap.removeAttr("style").addClass("fancybox-tmp"),b.trigger("onUpdate")),b.update())},hideLoading:function(){p.unbind(".loading");f("#fancybox-loading").remove()},showLoading:function(){var a,d;b.hideLoading();a=f('<div id="fancybox-loading"><div></div></div>').click(b.cancel).appendTo("body");p.bind("keydown.loading",function(a){if(27===(a.which||a.keyCode))a.preventDefault(),b.cancel()});b.defaults.fixed||(d=b.getViewport(),a.css({position:"absolute",top:0.5*d.h+d.y,left:0.5*d.w+d.x}))},getViewport:function(){var a=b.current&&b.current.locked||!1,d={x:n.scrollLeft(),y:n.scrollTop()};a?(d.w=a[0].clientWidth,d.h=a[0].clientHeight):(d.w=s&&r.innerWidth?r.innerWidth:n.width(),d.h=s&&r.innerHeight?r.innerHeight:n.height());return d},unbindEvents:function(){b.wrap&&t(b.wrap)&&b.wrap.unbind(".fb");p.unbind(".fb");n.unbind(".fb")},bindEvents:function(){var a=b.current,d;a&&(n.bind("orientationchange.fb"+(s?"":" resize.fb")+(a.autoCenter&&!a.locked?" scroll.fb":""),b.update),(d=a.keys)&&p.bind("keydown.fb",function(e){var c=e.which||e.keyCode,k=e.target||e.srcElement;if(27===c&&b.coming)return!1;!e.ctrlKey&&(!e.altKey&&!e.shiftKey&&!e.metaKey&&(!k||!k.type&&!f(k).is("[contenteditable]")))&&f.each(d,function(d,k){if(1<a.group.length&&k[c]!==v)return b[d](k[c]),e.preventDefault(),!1;if(-1<f.inArray(c,k))return b[d](),e.preventDefault(),!1})}),f.fn.mousewheel&&a.mouseWheel&&b.wrap.bind("mousewheel.fb",function(d,c,k,g){for(var h=f(d.target||null),j=!1;h.length&&!j&&!h.is(".fancybox-skin")&&!h.is(".fancybox-wrap");)j=h[0]&&!(h[0].style.overflow&&"hidden"===h[0].style.overflow)&&(h[0].clientWidth&&h[0].scrollWidth>h[0].clientWidth||h[0].clientHeight&&h[0].scrollHeight>h[0].clientHeight),h=f(h).parent();if(0!==c&&!j&&1<b.group.length&&!a.canShrink){if(0<g||0<k)b.prev(0<g?"down":"left");else if(0>g||0>k)b.next(0>g?"up":"right");d.preventDefault()}}))},trigger:function(a,d){var e,c=d||b.coming||b.current;if(c){f.isFunction(c[a])&&(e=c[a].apply(c,Array.prototype.slice.call(arguments,1)));if(!1===e)return!1;c.helpers&&f.each(c.helpers,function(d,e){if(e&&b.helpers[d]&&f.isFunction(b.helpers[d][a]))b.helpers[d][a](f.extend(!0,{},b.helpers[d].defaults,e),c)});p.trigger(a)}},isImage:function(a){return q(a)&&a.match(/(^data:image\/.*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg)((\?|#).*)?$)/i)},isSWF:function(a){return q(a)&&a.match(/\.(swf)((\?|#).*)?$/i)},_start:function(a){var d={},e,c;a=l(a);e=b.group[a]||null;if(!e)return!1;d=f.extend(!0,{},b.opts,e);e=d.margin;c=d.padding;"number"===f.type(e)&&(d.margin=[e,e,e,e]);"number"===f.type(c)&&(d.padding=[c,c,c,c]);d.modal&&f.extend(!0,d,{closeBtn:!1,closeClick:!1,nextClick:!1,arrows:!1,mouseWheel:!1,keys:null,helpers:{overlay:{closeClick:!1}}});d.autoSize&&(d.autoWidth=d.autoHeight=!0);"auto"===d.width&&(d.autoWidth=!0);"auto"===d.height&&(d.autoHeight=!0);d.group=b.group;d.index=a;b.coming=d;if(!1===b.trigger("beforeLoad"))b.coming=null;else{c=d.type;e=d.href;if(!c)return b.coming=null,b.current&&b.router&&"jumpto"!==b.router?(b.current.index=a,b[b.router](b.direction)):!1;b.isActive=!0;if("image"===c||"swf"===c)d.autoHeight=d.autoWidth=!1,d.scrolling="visible";"image"===c&&(d.aspectRatio=!0);"iframe"===c&&s&&(d.scrolling="scroll");d.wrap=f(d.tpl.wrap).addClass("fancybox-"+(s?"mobile":"desktop")+" fancybox-type-"+c+" fancybox-tmp "+d.wrapCSS).appendTo(d.parent||"body");f.extend(d,{skin:f(".fancybox-skin",d.wrap),outer:f(".fancybox-outer",d.wrap),inner:f(".fancybox-inner",d.wrap)});f.each(["Top","Right","Bottom","Left"],function(a,b){d.skin.css("padding"+b,w(d.padding[a]))});b.trigger("onReady");if("inline"===c||"html"===c){if(!d.content||!d.content.length)return b._error("content")}else if(!e)return b._error("href");"image"===c?b._loadImage():"ajax"===c?b._loadAjax():"iframe"===c?b._loadIframe():b._afterLoad()}},_error:function(a){f.extend(b.coming,{type:"html",autoWidth:!0,autoHeight:!0,minWidth:0,minHeight:0,scrolling:"no",hasError:a,content:b.coming.tpl.error});b._afterLoad()},_loadImage:function(){var a=b.imgPreload=new Image;a.onload=function(){this.onload=this.onerror=null;b.coming.width=this.width/b.opts.pixelRatio;b.coming.height=this.height/b.opts.pixelRatio;b._afterLoad()};a.onerror=function(){this.onload=this.onerror=null;b._error("image")};a.src=b.coming.href;!0!==a.complete&&b.showLoading()},_loadAjax:function(){var a=b.coming;b.showLoading();b.ajaxLoad=f.ajax(f.extend({},a.ajax,{url:a.href,error:function(a,e){b.coming&&"abort"!==e?b._error("ajax",a):b.hideLoading()},success:function(d,e){"success"===e&&(a.content=d,b._afterLoad())}}))},_loadIframe:function(){var a=b.coming,d=f(a.tpl.iframe.replace(/\{rnd\}/g,(new Date).getTime())).attr("scrolling",s?"auto":a.iframe.scrolling).attr("src",a.href);f(a.wrap).bind("onReset",function(){try{f(this).find("iframe").hide().attr("src","//about:blank").end().empty()}catch(a){}});a.iframe.preload&&(b.showLoading(),d.one("load",function(){f(this).data("ready",1);s||f(this).bind("load.fb",b.update);f(this).parents(".fancybox-wrap").width("100%").removeClass("fancybox-tmp").show();b._afterLoad()}));a.content=d.appendTo(a.inner);a.iframe.preload||b._afterLoad()},_preloadImages:function(){var a=b.group,d=b.current,e=a.length,c=d.preload?Math.min(d.preload,e-1):0,f,g;for(g=1;g<=c;g+=1)f=a[(d.index+g)%e],"image"===f.type&&f.href&&((new Image).src=f.href)},_afterLoad:function(){var a=b.coming,d=b.current,e,c,k,g,h;b.hideLoading();if(a&&!1!==b.isActive)if(!1===b.trigger("afterLoad",a,d))a.wrap.stop(!0).trigger("onReset").remove(),b.coming=null;else{d&&(b.trigger("beforeChange",d),d.wrap.stop(!0).removeClass("fancybox-opened").find(".fancybox-item, .fancybox-nav").remove());b.unbindEvents();e=a.content;c=a.type;k=a.scrolling;f.extend(b,{wrap:a.wrap,skin:a.skin,outer:a.outer,inner:a.inner,current:a,previous:d});g=a.href;switch(c){case "inline":case "ajax":case "html":a.selector?e=f("<div>").html(e).find(a.selector):t(e)&&(e.data("fancybox-placeholder")||e.data("fancybox-placeholder",f('<div class="fancybox-placeholder"></div>').insertAfter(e).hide()),e=e.show().detach(),a.wrap.bind("onReset",function(){f(this).find(e).length&&e.hide().replaceAll(e.data("fancybox-placeholder")).data("fancybox-placeholder",!1)}));break;case "image":e=a.tpl.image.replace("{href}",g);break;case "swf":e='<object id="fancybox-swf" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="100%" height="100%"><param name="movie" value="'+g+'"></param>',h="",f.each(a.swf,function(a,b){e+='<param name="'+a+'" value="'+b+'"></param>';h+=" "+a+'="'+b+'"'}),e+='<embed src="'+g+'" type="application/x-shockwave-flash" width="100%" height="100%"'+h+"></embed></object>"}(!t(e)||!e.parent().is(a.inner))&&a.inner.append(e);b.trigger("beforeShow");a.inner.css("overflow","yes"===k?"scroll":"no"===k?"hidden":k);b._setDimension();b.reposition();b.isOpen=!1;b.coming=null;b.bindEvents();if(b.isOpened){if(d.prevMethod)b.transitions[d.prevMethod]()}else f(".fancybox-wrap").not(a.wrap).stop(!0).trigger("onReset").remove();b.transitions[b.isOpened?a.nextMethod:a.openMethod]();b._preloadImages()}},_setDimension:function(){var a=b.getViewport(),d=0,e=!1,c=!1,e=b.wrap,k=b.skin,g=b.inner,h=b.current,c=h.width,j=h.height,m=h.minWidth,u=h.minHeight,n=h.maxWidth,p=h.maxHeight,s=h.scrolling,q=h.scrollOutside?h.scrollbarWidth:0,x=h.margin,y=l(x[1]+x[3]),r=l(x[0]+x[2]),v,z,t,C,A,F,B,D,H;e.add(k).add(g).width("auto").height("auto").removeClass("fancybox-tmp");x=l(k.outerWidth(!0)-k.width());v=l(k.outerHeight(!0)-k.height());z=y+x;t=r+v;C=E(c)?(a.w-z)*l(c)/100:c;A=E(j)?(a.h-t)*l(j)/100:j;if("iframe"===h.type){if(H=h.content,h.autoHeight&&1===H.data("ready"))try{H[0].contentWindow.document.location&&(g.width(C).height(9999),F=H.contents().find("body"),q&&F.css("overflow-x","hidden"),A=F.outerHeight(!0))}catch(G){}}else if(h.autoWidth||h.autoHeight)g.addClass("fancybox-tmp"),h.autoWidth||g.width(C),h.autoHeight||g.height(A),h.autoWidth&&(C=g.width()),h.autoHeight&&(A=g.height()),g.removeClass("fancybox-tmp");c=l(C);j=l(A);D=C/A;m=l(E(m)?l(m,"w")-z:m);n=l(E(n)?l(n,"w")-z:n);u=l(E(u)?l(u,"h")-t:u);p=l(E(p)?l(p,"h")-t:p);F=n;B=p;h.fitToView&&(n=Math.min(a.w-z,n),p=Math.min(a.h-t,p));z=a.w-y;r=a.h-r;h.aspectRatio?(c>n&&(c=n,j=l(c/D)),j>p&&(j=p,c=l(j*D)),c<m&&(c=m,j=l(c/D)),j<u&&(j=u,c=l(j*D))):(c=Math.max(m,Math.min(c,n)),h.autoHeight&&"iframe"!==h.type&&(g.width(c),j=g.height()),j=Math.max(u,Math.min(j,p)));if(h.fitToView)if(g.width(c).height(j),e.width(c+x),a=e.width(),y=e.height(),h.aspectRatio)for(;(a>z||y>r)&&(c>m&&j>u)&&!(19<d++);)j=Math.max(u,Math.min(p,j-10)),c=l(j*D),c<m&&(c=m,j=l(c/D)),c>n&&(c=n,j=l(c/D)),g.width(c).height(j),e.width(c+x),a=e.width(),y=e.height();else c=Math.max(m,Math.min(c,c-(a-z))),j=Math.max(u,Math.min(j,j-(y-r)));q&&("auto"===s&&j<A&&c+x+q<z)&&(c+=q);g.width(c).height(j);e.width(c+x);a=e.width();y=e.height();e=(a>z||y>r)&&c>m&&j>u;c=h.aspectRatio?c<F&&j<B&&c<C&&j<A:(c<F||j<B)&&(c<C||j<A);f.extend(h,{dim:{width:w(a),height:w(y)},origWidth:C,origHeight:A,canShrink:e,canExpand:c,wPadding:x,hPadding:v,wrapSpace:y-k.outerHeight(!0),skinSpace:k.height()-j});!H&&(h.autoHeight&&j>u&&j<p&&!c)&&g.height("auto")},_getPosition:function(a){var d=b.current,e=b.getViewport(),c=d.margin,f=b.wrap.width()+c[1]+c[3],g=b.wrap.height()+c[0]+c[2],c={position:"absolute",top:c[0],left:c[3]};d.autoCenter&&d.fixed&&!a&&g<=e.h&&f<=e.w?c.position="fixed":d.locked||(c.top+=e.y,c.left+=e.x);c.top=w(Math.max(c.top,c.top+(e.h-g)*d.topRatio));c.left=w(Math.max(c.left,c.left+(e.w-f)*d.leftRatio));return c},_afterZoomIn:function(){var a=b.current;a&&(b.isOpen=b.isOpened=!0,b.wrap.css("overflow","visible").addClass("fancybox-opened"),b.update(),(a.closeClick||a.nextClick&&1<b.group.length)&&b.inner.css("cursor","pointer").bind("click.fb",function(d){!f(d.target).is("a")&&!f(d.target).parent().is("a")&&(d.preventDefault(),b[a.closeClick?"close":"next"]())}),a.closeBtn&&f(a.tpl.closeBtn).appendTo(b.skin).bind("click.fb",function(a){a.preventDefault();b.close()}),a.arrows&&1<b.group.length&&((a.loop||0<a.index)&&f(a.tpl.prev).appendTo(b.outer).bind("click.fb",b.prev),(a.loop||a.index<b.group.length-1)&&f(a.tpl.next).appendTo(b.outer).bind("click.fb",b.next)),b.trigger("afterShow"),!a.loop&&a.index===a.group.length-1?b.play(!1):b.opts.autoPlay&&!b.player.isActive&&(b.opts.autoPlay=!1,b.play()))},_afterZoomOut:function(a){a=a||b.current;f(".fancybox-wrap").trigger("onReset").remove();f.extend(b,{group:{},opts:{},router:!1,current:null,isActive:!1,isOpened:!1,isOpen:!1,isClosing:!1,wrap:null,skin:null,outer:null,inner:null});b.trigger("afterClose",a)}});b.transitions={getOrigPosition:function(){var a=b.current,d=a.element,e=a.orig,c={},f=50,g=50,h=a.hPadding,j=a.wPadding,m=b.getViewport();!e&&(a.isDom&&d.is(":visible"))&&(e=d.find("img:first"),e.length||(e=d));t(e)?(c=e.offset(),e.is("img")&&(f=e.outerWidth(),g=e.outerHeight())):(c.top=m.y+(m.h-g)*a.topRatio,c.left=m.x+(m.w-f)*a.leftRatio);if("fixed"===b.wrap.css("position")||a.locked)c.top-=m.y,c.left-=m.x;return c={top:w(c.top-h*a.topRatio),left:w(c.left-j*a.leftRatio),width:w(f+j),height:w(g+h)}},step:function(a,d){var e,c,f=d.prop;c=b.current;var g=c.wrapSpace,h=c.skinSpace;if("width"===f||"height"===f)e=d.end===d.start?1:(a-d.start)/(d.end-d.start),b.isClosing&&(e=1-e),c="width"===f?c.wPadding:c.hPadding,c=a-c,b.skin[f](l("width"===f?c:c-g*e)),b.inner[f](l("width"===f?c:c-g*e-h*e))},zoomIn:function(){var a=b.current,d=a.pos,e=a.openEffect,c="elastic"===e,k=f.extend({opacity:1},d);delete k.position;c?(d=this.getOrigPosition(),a.openOpacity&&(d.opacity=0.1)):"fade"===e&&(d.opacity=0.1);b.wrap.css(d).animate(k,{duration:"none"===e?0:a.openSpeed,easing:a.openEasing,step:c?this.step:null,complete:b._afterZoomIn})},zoomOut:function(){var a=b.current,d=a.closeEffect,e="elastic"===d,c={opacity:0.1};e&&(c=this.getOrigPosition(),a.closeOpacity&&(c.opacity=0.1));b.wrap.animate(c,{duration:"none"===d?0:a.closeSpeed,easing:a.closeEasing,step:e?this.step:null,complete:b._afterZoomOut})},changeIn:function(){var a=b.current,d=a.nextEffect,e=a.pos,c={opacity:1},f=b.direction,g;e.opacity=0.1;"elastic"===d&&(g="down"===f||"up"===f?"top":"left","down"===f||"right"===f?(e[g]=w(l(e[g])-200),c[g]="+=200px"):(e[g]=w(l(e[g])+200),c[g]="-=200px"));"none"===d?b._afterZoomIn():b.wrap.css(e).animate(c,{duration:a.nextSpeed,easing:a.nextEasing,complete:b._afterZoomIn})},changeOut:function(){var a=b.previous,d=a.prevEffect,e={opacity:0.1},c=b.direction;"elastic"===d&&(e["down"===c||"up"===c?"top":"left"]=("up"===c||"left"===c?"-":"+")+"=200px");a.wrap.animate(e,{duration:"none"===d?0:a.prevSpeed,easing:a.prevEasing,complete:function(){f(this).trigger("onReset").remove()}})}};b.helpers.overlay={defaults:{closeClick:!0,speedOut:200,showEarly:!0,css:{},locked:!s,fixed:!0},overlay:null,fixed:!1,el:f("html"),create:function(a){a=f.extend({},this.defaults,a);this.overlay&&this.close();this.overlay=f('<div class="fancybox-overlay"></div>').appendTo(b.coming?b.coming.parent:a.parent);this.fixed=!1;a.fixed&&b.defaults.fixed&&(this.overlay.addClass("fancybox-overlay-fixed"),this.fixed=!0)},open:function(a){var d=this;a=f.extend({},this.defaults,a);this.overlay?this.overlay.unbind(".overlay").width("auto").height("auto"):this.create(a);this.fixed||(n.bind("resize.overlay",f.proxy(this.update,this)),this.update());a.closeClick&&this.overlay.bind("click.overlay",function(a){if(f(a.target).hasClass("fancybox-overlay"))return b.isActive?b.close():d.close(),!1});this.overlay.css(a.css).show()},close:function(){var a,b;n.unbind("resize.overlay");this.el.hasClass("fancybox-lock")&&(f(".fancybox-margin").removeClass("fancybox-margin"),a=n.scrollTop(),b=n.scrollLeft(),this.el.removeClass("fancybox-lock"),n.scrollTop(a).scrollLeft(b));f(".fancybox-overlay").remove().hide();f.extend(this,{overlay:null,fixed:!1})},update:function(){var a="100%",b;this.overlay.width(a).height("100%");I?(b=Math.max(G.documentElement.offsetWidth,G.body.offsetWidth),p.width()>b&&(a=p.width())):p.width()>n.width()&&(a=p.width());this.overlay.width(a).height(p.height())},onReady:function(a,b){var e=this.overlay;f(".fancybox-overlay").stop(!0,!0);e||this.create(a);a.locked&&(this.fixed&&b.fixed)&&(e||(this.margin=p.height()>n.height()?f("html").css("margin-right").replace("px",""):!1),b.locked=this.overlay.append(b.wrap),b.fixed=!1);!0===a.showEarly&&this.beforeShow.apply(this,arguments)},beforeShow:function(a,b){var e,c;b.locked&&(!1!==this.margin&&(f("*").filter(function(){return"fixed"===f(this).css("position")&&!f(this).hasClass("fancybox-overlay")&&!f(this).hasClass("fancybox-wrap")}).addClass("fancybox-margin"),this.el.addClass("fancybox-margin")),e=n.scrollTop(),c=n.scrollLeft(),this.el.addClass("fancybox-lock"),n.scrollTop(e).scrollLeft(c));this.open(a)},onUpdate:function(){this.fixed||this.update()},afterClose:function(a){this.overlay&&!b.coming&&this.overlay.fadeOut(a.speedOut,f.proxy(this.close,this))}};b.helpers.title={defaults:{type:"float",position:"bottom"},beforeShow:function(a){var d=b.current,e=d.title,c=a.type;f.isFunction(e)&&(e=e.call(d.element,d));if(q(e)&&""!==f.trim(e)){d=f('<div class="fancybox-title fancybox-title-'+c+'-wrap">'+e+"</div>");switch(c){case "inside":c=b.skin;break;case "outside":c=b.wrap;break;case "over":c=b.inner;break;default:c=b.skin,d.appendTo("body"),I&&d.width(d.width()),d.wrapInner('<span class="child"></span>'),b.current.margin[2]+=Math.abs(l(d.css("margin-bottom")))}d["top"===a.position?"prependTo":"appendTo"](c)}}};f.fn.fancybox=function(a){var d,e=f(this),c=this.selector||"",k=function(g){var h=f(this).blur(),j=d,k,l;!g.ctrlKey&&(!g.altKey&&!g.shiftKey&&!g.metaKey)&&!h.is(".fancybox-wrap")&&(k=a.groupAttr||"data-fancybox-group",l=h.attr(k),l||(k="rel",l=h.get(0)[k]),l&&(""!==l&&"nofollow"!==l)&&(h=c.length?f(c):e,h=h.filter("["+k+'="'+l+'"]'),j=h.index(this)),a.index=j,!1!==b.open(h,a)&&g.preventDefault())};a=a||{};d=a.index||0;!c||!1===a.live?e.unbind("click.fb-start").bind("click.fb-start",k):p.undelegate(c,"click.fb-start").delegate(c+":not('.fancybox-item, .fancybox-nav')","click.fb-start",k);this.filter("[data-fancybox-start=1]").trigger("click");return this};p.ready(function(){var a,d;f.scrollbarWidth===v&&(f.scrollbarWidth=function(){var a=f('<div style="width:50px;height:50px;overflow:auto"><div/></div>').appendTo("body"),b=a.children(),b=b.innerWidth()-b.height(99).innerWidth();a.remove();return b});if(f.support.fixedPosition===v){a=f.support;d=f('<div style="position:fixed;top:20px;"></div>').appendTo("body");var e=20===d[0].offsetTop||15===d[0].offsetTop;d.remove();a.fixedPosition=e}f.extend(b.defaults,{scrollbarWidth:f.scrollbarWidth(),fixed:f.support.fixedPosition,parent:f("body")});a=f(r).width();J.addClass("fancybox-lock-test");d=f(r).width();J.removeClass("fancybox-lock-test");f("<style type='text/css'>.fancybox-margin{margin-right:"+(d-a)+"px;}</style>").appendTo("head")})})(window,document,jQuery);(function($){var F=$.fancybox;F.helpers.buttons={defaults:{skipSingle:false,position:"top",tpl:'<div id="fancybox-buttons"><ul><li><a class="btnPrev" title="Previous" href="javascript:;"></a></li><li><a class="btnPlay" title="Start slideshow" href="javascript:;"></a></li><li><a class="btnNext" title="Next" href="javascript:;"></a></li><li><a class="btnToggle" title="Toggle size" href="javascript:;"></a></li><li><a class="btnClose" title="Close" href="javascript:;"></a></li></ul></div>'},list:null,buttons:null,beforeLoad:function(opts,obj){if(opts.skipSingle&&obj.group.length<2){obj.helpers.buttons=false;obj.closeBtn=true;return}obj.margin[opts.position==="bottom"?2:0]+=30},onPlayStart:function(){if(this.buttons)this.buttons.play.attr("title","Pause slideshow").addClass("btnPlayOn")},onPlayEnd:function(){if(this.buttons)this.buttons.play.attr("title","Start slideshow").removeClass("btnPlayOn")},afterShow:function(opts,obj){var buttons=this.buttons;if(!buttons){this.list=$(opts.tpl).addClass(opts.position).appendTo("body");buttons={prev:this.list.find(".btnPrev").click(F.prev),next:this.list.find(".btnNext").click(F.next),play:this.list.find(".btnPlay").click(F.play),toggle:this.list.find(".btnToggle").click(F.toggle),close:this.list.find(".btnClose").click(F.close)}}if(obj.index>0||obj.loop)buttons.prev.removeClass("btnDisabled");else buttons.prev.addClass("btnDisabled");if(obj.loop||obj.index<obj.group.length-1){buttons.next.removeClass("btnDisabled");buttons.play.removeClass("btnDisabled")}else{buttons.next.addClass("btnDisabled");buttons.play.addClass("btnDisabled")}this.buttons=buttons;this.onUpdate(opts,obj)},onUpdate:function(opts,obj){var toggle;if(!this.buttons)return;toggle=this.buttons.toggle.removeClass("btnDisabled btnToggleOn");if(obj.canShrink)toggle.addClass("btnToggleOn");else if(!obj.canExpand)toggle.addClass("btnDisabled")},beforeClose:function(){if(this.list)this.list.remove();this.list=null;this.buttons=null}}})(jQuery);// jQuery.Cookie(function(factory){if(typeof define==='function'&&define.amd){define(['jquery'],factory);}else{factory(jQuery);}}(function($){var pluses=/\+/g;function encode(s){return config.raw?s:encodeURIComponent(s);}function decode(s){return config.raw?s:decodeURIComponent(s);}function stringifyCookieValue(value){return encode(config.json?JSON.stringify(value):String(value));}function parseCookieValue(s){if(s.indexOf('"')===0){s=s.slice(1,-1).replace(/\\"/g,'"').replace(/\\\\/g,'\\');}try{s=decodeURIComponent(s.replace(pluses,' '));}catch(e){return;}try{return config.json?JSON.parse(s):s;}catch(e){}}function read(s,converter){var value=config.raw?s:parseCookieValue(s);return $.isFunction(converter)?converter(value):value;}var config=$.cookie=function(key,value,options){if(value!==undefined&&!$.isFunction(value)){options=$.extend({},config.defaults,options);if(typeof options.expires==='number'){var days=options.expires,t=options.expires=new Date();t.setDate(t.getDate()+days);}return(document.cookie=[encode(key),'=',stringifyCookieValue(value),options.expires?'; expires='+options.expires.toUTCString():'',options.path?'; path='+options.path:'',options.domain?'; domain='+options.domain:'',options.secure?'; secure':''].join(''));}var result=key?undefined:{};var cookies=document.cookie?document.cookie.split('; '):[];for(var i=0,l=cookies.length;i<l;i++){var parts=cookies[i].split('=');var name=decode(parts.shift());var cookie=parts.join('=');if(key&&key===name){result=read(cookie,value);break;}if(!key&&(cookie=read(cookie))!==undefined){result[name]=cookie;}}return result;};config.defaults={};$.removeCookie=function(key,options){if($.cookie(key)!==undefined){$.cookie(key,'',$.extend({},options,{expires:-1}));return true;}return false;};}));// LocationSelect.jsvar com={elfvision:{}};com.elfvision.kit={};com.elfvision.kit.LocationSelect={};com.elfvision.ajax={};com.elfvision.DEBUG=!1;(function(){var f,k,m,g,n,w,x,q,r,s,t,c,y,u,l,z,h;if(com.elfvision.DEBUG){var B=(new Date).getTime();c=function(){for(var a=0,b=arguments.length,d=["[DEBUG at ",(new Date).getTime()-B," ] : "];a<b;a++)d.push(arguments[a]);void 0!==window.console&&"function"==typeof window.console.log&&console.log.apply(console,d)}}else c=function(){};u=function(a,b){return function(){b.apply(a,arguments)}};y=function(a,b,d,e){c("attaching event",b,"on the object",a);var j=function(b){d.apply(e||a,[b])};void 0!==window.jQuery?jQuery(a).bind(b,j):document.addEventListener?a.addEventListener(b,j,!1):document.attachEvent&&(j=function(b){b||(b=window.event);d.apply(e||a,[{_event:b,type:b.type,target:b.srcElement,currentTarget:a,relatedTarget:b.fromElement?b.fromElement:b.toElement,eventPhase:b.srcElement==a?2:3,clientX:b.clientX,clientY:b.clientY,screenX:b.screenX,screenY:b.screenY,altKey:b.altKey,ctrlKey:b.ctrlKey,shiftKey:b.shiftKey,charCode:b.keyCode,stopPropagation:function(){this._event.cancelBubble=!0},preventDefault:function(){this._event.returnValue=!1}}])},a.attachEvent("on"+b,j))};var p,A=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];q={create:function(){if(p)return p();for(var a=0;a<A.length;a++)try{var b=A[a],d=b();if(d)return p=b,d}catch(c){}p=function(){throw Error("XMLHttpRequest not supported");};p()}};r=function(a){if(!a.url)throw Error("getJson : Must provide url for the request!");var b=q.create();b.onreadystatechange=function(){c("Request Object ",b);if(4==b.readyState&&(200==b.status||0===b.status))if(c("JSON is successfully retrived according to ",a),a.callback){c("about to parse json");var jsons = b.responseText;var d;if (typeof(JSON) == 'undefined'){d = eval("("+jsons+")");}else{d= JSON.parse(jsons);}c("parsed ",d);a.callback.call(this,d)}};b.open("GET",a.url,!0);b.setRequestHeader("Cache-Control","max-age=0,no-cache,no-store,post-check=0,pre-check=0");b.setRequestHeader("Expires","Mon, 26 Jul 1997 05:00:00 GMT");b.send(null)};s=function(a,b){var d=document.createElement("script"),c,j;b&&(c=/callback=(\w+)&*/,j=c.exec(a)[1],window[j]=function(a){b(a);window[j]=null});d.src=a;document.getElementsByTagName("head")[0].appendChild(d)};t=function(a,b){var d=document.createElement("script");d.src=a;c("getting script",a);b&&(d.onload=b,d.onreadystatechange=function(){(4==d.readyState||"loaded"==d.readyState||"complete"==d.readyState)&&b()});document.getElementsByTagName("head")[0].appendChild(d)};h=function(a,b){if(Array.prototype.forEach)return Array.prototype.forEach.call(a,b);var d=a.length>>>0;if("function"!=typeof b)throw new TypeError;for(var c=0;c<d;c++)c in a&&b.call(b,a[c],c,this)};z=function(a){if(a&&"object"===typeof a&&a.constructor===Array)return!0};l=function(){this.observers=[];this.guid=0};l.prototype.subscribe=function(a){var b=this.guid++;this.observers[b]=a;return b};l.prototype.unSubscribe=function(a){delete this.observers[a]};l.prototype.notify=function(a){for(var b in this.observers){var d=this.observers[b];d instanceof Function?d.call(this,a):d.update.call(this,a)}};f=function(a){this.onRowsInserted=new l;this.onRowsRemoved=new l;this.onRowsUpdated=new l;this.onSelectedIndexChanged=new l;this.items=[];this.selectedIndex=0;this.level=a.level||0;this.label=a.label||"Select..."};f.prototype.read=function(a){return a?(c("reading items["+a+"]:",this.items[a]),this.items[a]):this.items};f.prototype.insert=function(a){z(a)?(a=[a],this.items=this.items.concat(a)):this.items.push(a);this.onRowsInserted.notify({source:this,items:a})};f.prototype.remove=function(a){var b;a?h(this.items,function(d,c){d.id===a&&(b=d,this.items.splice(c,1))}):this.items=[];c("notifying removing");this.onRowsRemoved.notify({source:this,items:[b]})};f.prototype.update=function(a){a=a||[];c("updating list model with ",a);this.items=[{id:0,text:this.label}].concat(a);c("notifying updating");this.onRowsUpdated.notify({source:this,items:a})};f.prototype.getSelectedIndex=function(){return this.selectedIndex};f.prototype.setSelectedIndex=function(a){var b=this.getSelectedIndex();b!==a&&(this.selectedIndex=a,c("notifying index changed",a),this.onSelectedIndexChanged.notify({source:this,previous:b,present:a,previousItem:this.read(b),presentItem:this.read(a),level:this.level}))};k=function(a){this.model=a.model;this.controller=a.controller;this.element=a.element;a=u(this,this.rebuildList);var b=u(this.controller.parent,this.controller.parent.update);this.model.onRowsInserted.subscribe(a);this.model.onRowsRemoved.subscribe(a);this.model.onRowsUpdated.subscribe(a);this.model.onSelectedIndexChanged.subscribe(b);c("this list item",this);y(this.element,"change",this.controller.updateSelectedIndex,this.controller)};k.prototype.show=function(){this.element.style.display="inline-block"};k.prototype.hide=function(){this.element.style.display="none"};k.prototype.rebuildList=function(a){if(a&&a.present&&0===a.present)this.elements.list.selectedIndex=0;else{c("Rebuilding list ",this);var b=this.element;a=this.model.read();var d;b.innerHTML="";c(a.length);h(a,function(a){d=new Option;d.setAttribute("value",a.id?a.text:"");d.appendChild(document.createTextNode(a.text));b.appendChild(d)});this.model.setSelectedIndex(0)}};m=function(a){this.parent=a.parent;this.model=new f({level:a.level,label:a.label});this.view=new k({model:this.model,controller:this,element:a.element})};m.prototype.refresh=function(a){c("refresh data with ",a);this.model.update(a)};m.prototype.updateSelectedIndex=function(a){this.model.setSelectedIndex(a.target.selectedIndex)};m.prototype.selectByText=function(a){var b=this;h(this.model.read(),function(d,e){d.text.match("^"+a)==a&&(c("auto detected ",d,e),b.model.setSelectedIndex(e),b.view.element.selectedIndex=e)})};m.prototype.selectByID=function(a){var b=this;h(this.model.read(),function(d,e){d.id.toString().match("^"+a)==a&&(c("auto detected ",d,e),b.model.setSelectedIndex(e),b.view.element.selectedIndex=e)})};m.prototype.getValue=function(){return this.model.read(this.model.getSelectedIndex()).text};g=function(a){this.labels=a.labels;this.currentGeo={};this.lists=[];this.elements=a.elements;this.parent=a.parent};g.prototype.init=function(){c("init select group");for(var a=0,b=this.labels.length;a<b;a++)this.lists.push(new m({label:this.labels[a],element:this.elements[a],level:a,parent:this}));c("lists built ",this);c(this.parent.listHelper.find(-1));this.lists[0].refresh(this.parent.listHelper.find(-1));this.lists[0].view.show()};g.prototype.update=function(a){if(a.level!=this.lists.length-1)if(c("Updating SelectGroup contents",this),0===a.present){a=a.level+1;for(var b=this.lists.length;a<b;a++)this.lists[a].refresh(),this.lists[a].view.hide()}else{switch(a.level){case 0:this.currentGeo.province=a.presentItem.text;break;case 1:this.currentGeo.city=a.presentItem.text;break;case 2:this.currentGeo.district=a.presentItem.text}this.lists[a.level+1].refresh(this.parent.listHelper.find(a.level,a.presentItem.id));this.lists[a.level+1].view.show()}};g.prototype.setValues=function(a){c("setting group values",a);var b=this;h(a,function(a,c){a&&b.lists[c].selectByText(a)})};g.prototype.setValuesID=function(a){c("setting group values",a);var b=this;h(a,function(a,c){a&&b.lists[c].selectByID(a)})};g.prototype.setValuesCode=function(a){c("setting group values",a);var b=this;h(a,function(a,c){a&&b.lists[c].selectByText(a)})};g.prototype.getValues=function(){var a=[];h(this.lists,function(b){a.push(b.getValue())});return a};n=function(a){this.detectGeoLocation=void 0===a.detectGeoLocation?!0:a.detectGeoLocation;this.detector=a.detector||w;this.listHelper=a.listHelper||x.getInstance({dataUrl:a.dataUrl});this.selectGroup=new g({parent:this,labels:a.labels,elements:a.elements});var b=this;this.listHelper.fetch(function(){c("exec fetech callback");b.selectGroup.init();b.detectGeoLocation&&b.detector()})};n.prototype.report=function(){return this.selectGroup.getValues()};n.prototype.select=function(a){this.selectGroup.setValues(a)};n.prototype.selectID=function(a){this.selectGroup.setValuesID(a)};w=function(){c("Detect!!!!");var a=this,b;t("http://j.maxmind.com/app/geoip.js",function(){c("Maxmind API Loaded!");b="http://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20json%20where%0A%20%20url%3D%22http%3A%2F%2Fmaps.google.com%2Fmaps%2Fapi%2Fgeocode%2Fjson%3Flatlng%3D"+geoip_latitude()+"%2C"+geoip_longitude()+"%26sensor%3Dfalse%26language%3Dzh-CN%22&format=json&diagnostics=true&callback=locationselectcb";s(b,function(b){c("Geocoder Request Completed through YQL ",b);if("OK"===b.query.results.json.status){b=b.query.results.json.results[0].address_components;var e,j;c("Geocoder statuts ok",b);h(b,function(a){var b=a.types[0];"locality"===b?e=a.long_name:"administrative_area_level_1"===b&&(j=a.long_name)});a.select([j,e])}})})};var v;x={getInstance:function(a){if(!v){var b=a.dataUrl||"js/areas.js",d,e={};d={get:function(a){return e[a]},set:function(a,b){e[a]=b}};v={fetch:function(a){c("feteching areas data");r({url:b,callback:function(b){c("area data : ",b);d.set("province",b.province);d.set("city",b.city);d.set("district",b.district);a()}})},find:function(a,b){var e=[];c("querying by record id : ",b,"by list in level : ",a);if(d.get(b))c("lucky! we have it cached"),e=d.get(b);else if(c("finding it in areas data"),-1===a)c("this is a query for province data"),e=d.get("province");else{var f=b.toString().substring(0,2*(a+1)),k=RegExp("^"+f+"\\d*"),g=0===a?d.get("city"):d.get("district");h(g,function(a,b){k.test(a.id)&&e.push(g[b])})}c("Return results : ",e);return e}}}return v}};com.elfvision.kit.LocationSelect=n;com.elfvision.ajax.XhrFactory=q;com.elfvision.ajax.getJson=r;com.elfvision.ajax.jsonp=s;com.elfvision.ajax.getScript=t})();void 0!==window.jQuery&&($.LocationSelect={build:function(f){var k;f.elements=this.get();k=new com.elfvision.kit.LocationSelect(f);$.LocationSelect.all[f.name]=k;return this}},$.LocationSelect.all={},$.fn.LocationSelect=$.LocationSelect.build);// AJAX Uploadervar _ajax_uploader = _ajax_uploader || {};/** * Adds all missing properties from second obj to first obj */ _ajax_uploader.extend = function(first, second) {	    for (var prop in second){        first[prop] = second[prop];    }};  /** * Searches for a given element in the array, returns -1 if it is not present. * @param {Number} [from] The index at which to begin the search */_ajax_uploader.indexOf = function(arr, elt, from){    if (arr.indexOf) return arr.indexOf(elt, from);        from = from || 0;    var len = arr.length;            if (from < 0) from += len;      for (; from < len; from++){          if (from in arr && arr[from] === elt){              return from;        }    }      return -1;  };     _ajax_uploader.getUniqueId = (function(){    var id = 0;    return function(){ return id++; };})();//// Events_ajax_uploader.attach = function(element, type, fn){    if (element.addEventListener){        element.addEventListener(type, fn, false);    } else if (element.attachEvent){        element.attachEvent('on' + type, fn);    }};_ajax_uploader.detach = function(element, type, fn){    if (element.removeEventListener){        element.removeEventListener(type, fn, false);    } else if (element.attachEvent){        element.detachEvent('on' + type, fn);    }};_ajax_uploader.preventDefault = function(e){    if (e.preventDefault){        e.preventDefault();    } else{        e.returnValue = false;    }};//// Node manipulations/** * Insert node a before node b. */_ajax_uploader.insertBefore = function(a, b){    b.parentNode.insertBefore(a, b);};_ajax_uploader.remove = function(element){    element.parentNode.removeChild(element);};_ajax_uploader.contains = function(parent, descendant){           // compareposition returns false in this case    if (parent == descendant) return true;        if (parent.contains){        return parent.contains(descendant);    } else {        return !!(descendant.compareDocumentPosition(parent) & 8);    }};/** * Creates and returns element from html string * Uses innerHTML to create an element */_ajax_uploader.toElement = (function(){    var div = document.createElement('div');    return function(html){        div.innerHTML = html;        var element = div.firstChild;        div.removeChild(element);        return element;    };})();//// Node properties and attributes/** * Sets styles for an element. * Fixes opacity in IE6-8. */_ajax_uploader.css = function(element, styles){    if (styles.opacity != null){        if (typeof element.style.opacity != 'string' && typeof(element.filters) != 'undefined'){            styles.filter = 'alpha(opacity=' + Math.round(100 * styles.opacity) + ')';        }    }    _ajax_uploader.extend(element.style, styles);};_ajax_uploader.hasClass = function(element, name){    var re = new RegExp('(^| )' + name + '( |$)');    return re.test(element.className);};_ajax_uploader.addClass = function(element, name){    if (!_ajax_uploader.hasClass(element, name)){        element.className += ' ' + name;    }};_ajax_uploader.removeClass = function(element, name){    var re = new RegExp('(^| )' + name + '( |$)');    element.className = element.className.replace(re, ' ').replace(/^\s+|\s+$/g, "");};_ajax_uploader.setText = function(element, text){    element.innerText = text;    element.textContent = text;};_ajax_uploader.setHTML = function(element, html){    element.innerHTML = html;};//// Selecting elements_ajax_uploader.children = function(element){    var children = [],    child = element.firstChild;    while (child){        if (child.nodeType == 1){            children.push(child);        }        child = child.nextSibling;    }    return children;};_ajax_uploader.getByClass = function(element, className){    if (element.querySelectorAll){        return element.querySelectorAll('.' + className);    }    var result = [];    var candidates = element.getElementsByTagName("*");    var len = candidates.length;    for (var i = 0; i < len; i++){        if (_ajax_uploader.hasClass(candidates[i], className)){            result.push(candidates[i]);        }    }    return result;};/** * obj2url() takes a json-object as argument and generates * a querystring. pretty much like jQuery.param() *  * how to use: * *    `_ajax_uploader.obj2url({a:'b',c:'d'},'http://any.url/upload?otherParam=value');` * * will result in: * *    `http://any.url/upload?otherParam=value&a=b&c=d` * * @param  Object JSON-Object * @param  String current querystring-part * @return String encoded querystring */_ajax_uploader.obj2url = function(obj, temp, prefixDone){    var uristrings = [],        prefix = '&',        add = function(nextObj, i){            var nextTemp = temp                 ? (/\[\]$/.test(temp)) // prevent double-encoding                   ? temp                   : temp+'['+i+']'                : i;            if ((nextTemp != 'undefined') && (i != 'undefined')) {                  uristrings.push(                    (typeof nextObj === 'object')                         ? _ajax_uploader.obj2url(nextObj, nextTemp, true)                        : (Object.prototype.toString.call(nextObj) === '[object Function]')                            ? encodeURIComponent(nextTemp) + '=' + encodeURIComponent(nextObj())                            : encodeURIComponent(nextTemp) + '=' + encodeURIComponent(nextObj)                                                                          );            }        };     if (!prefixDone && temp) {      prefix = (/\?/.test(temp)) ? (/\?$/.test(temp)) ? '' : '&' : '?';      uristrings.push(temp);      uristrings.push(_ajax_uploader.obj2url(obj));    } else if ((Object.prototype.toString.call(obj) === '[object Array]') && (typeof obj != 'undefined') ) {        // we wont use a for-in-loop on an array (performance)        for (var i = 0, len = obj.length; i < len; ++i){            add(obj[i], i);        }    } else if ((typeof obj != 'undefined') && (obj !== null) && (typeof obj === "object")){        // for anything else but a scalar, we will use for-in-loop        for (var i in obj){            add(obj[i], i);        }    } else {        uristrings.push(encodeURIComponent(temp) + '=' + encodeURIComponent(obj));    }    return uristrings.join(prefix)                     .replace(/^&/, '')                     .replace(/%20/g, '+'); };////// Uploader Classes////	var _ajax_uploader = _ajax_uploader || {};  /** * Creates upload button, validates upload, but doesn't create file list or dd.  */_ajax_uploader.FileUploaderBasic = function(o){	    this._options = {        // set to true to see the server response        debug: false,        action: '/server/upload',        params: {},        button: null,        multiple: true,        maxConnections: 3,        // validation                allowedExtensions: [],                       sizeLimit: 0,           minSizeLimit: 0,                                     // events        // return false to cancel submit        onSubmit: function(id, fileName){},        onProgress: function(id, fileName, loaded, total){},        onComplete: function(id, fileName, responseJSON){},        onCancel: function(id, fileName){},        // messages                        messages: {            typeError: _t('{file} 是个无效文件, 只接受下列文件: {extensions}'),            sizeError: _t('{file} 文件尺寸太大, 最大文件尺寸为: {sizeLimit}'),            minSizeError: _t('{file} 文件尺寸太小, 最小文件尺寸为:  {minSizeLimit}'),            emptyError: _t('{file} 是个空文件, 请重新选择'),            onLeave: _t('文件正在上传, 是否中断继续')                  },        showMessage: function(message){            $.alert(message);        }                   };    _ajax_uploader.extend(this._options, o);            // number of files being uploaded    this._filesInProgress = 0;    this._handler = this._createUploadHandler();         if (this._options.button){         this._button = this._createUploadButton(this._options.button);    }                            this._preventLeaveInProgress();         };   _ajax_uploader.FileUploaderBasic.prototype = {    setParams: function(params){        this._options.params = params;    },    getInProgress: function(){        return this._filesInProgress;             },    _createUploadButton: function(element){        var self = this;                return new _ajax_uploader.UploadButton({            element: element,            multiple: this._options.multiple && _ajax_uploader.UploadHandlerXhr.isSupported(),            onChange: function(input){                self._onInputChange(input);            }                });               },        _createUploadHandler: function(){        var self = this,            handlerClass;                        if(_ajax_uploader.UploadHandlerXhr.isSupported()){                       handlerClass = 'UploadHandlerXhr';                                } else {            handlerClass = 'UploadHandlerForm';        }        var handler = new _ajax_uploader[handlerClass]({            debug: this._options.debug,            action: this._options.action,                     maxConnections: this._options.maxConnections,               onProgress: function(id, fileName, loaded, total){                                self._onProgress(id, fileName, loaded, total);                self._options.onProgress(id, fileName, loaded, total);                                },                        onComplete: function(id, fileName, result){                self._onComplete(id, fileName, result);                self._options.onComplete(id, fileName, result);            },            onCancel: function(id, fileName){                self._onCancel(id, fileName);                self._options.onCancel(id, fileName);            }        });        return handler;    },        _preventLeaveInProgress: function(){        var self = this;                _ajax_uploader.attach(window, 'beforeunload', function(e){            if (!self._filesInProgress){return;}                        var e = e || window.event;            // for ie, ff            e.returnValue = self._options.messages.onLeave;            // for webkit            return self._options.messages.onLeave;                     });            },        _onSubmit: function(id, fileName){        this._filesInProgress++;      },    _onProgress: function(id, fileName, loaded, total){            },    _onComplete: function(id, fileName, result){        this._filesInProgress--;                         if (result.error){            this._options.showMessage(result.error);        }                 },    _onCancel: function(id, fileName){        this._filesInProgress--;            },    _onInputChange: function(input){        if (this._handler instanceof _ajax_uploader.UploadHandlerXhr){                            this._uploadFileList(input.files);                           } else {                         if (this._validateFile(input)){                                this._uploadFile(input);                                                }                              }                       this._button.reset();       },      _uploadFileList: function(files){        for (var i=0; i<files.length; i++){            if ( !this._validateFile(files[i])){                return;            }                    }                for (var i=0; i<files.length; i++){            this._uploadFile(files[i]);                }            },           _uploadFile: function(fileContainer){              var id = this._handler.add(fileContainer);        var fileName = this._handler.getName(id);                if (this._options.onSubmit(id, fileName) !== false){            this._onSubmit(id, fileName);            this._handler.upload(id, this._options.params);        }    },          _validateFile: function(file){        var name, size;                if (file.value){            // it is a file input                        // get input value and remove path to normalize            name = file.value.replace(/.*(\/|\\)/, "");        } else {            // fix missing properties in Safari            name = file.fileName != null ? file.fileName : file.name;            size = file.fileSize != null ? file.fileSize : file.size;        }                            if (! this._isAllowedExtension(name)){                        this._error('typeError', name);            return false;                    } else if (size === 0){                        this._error('emptyError', name);            return false;                                                             } else if (size && this._options.sizeLimit && size > this._options.sizeLimit){                        this._error('sizeError', name);            return false;                                } else if (size && size < this._options.minSizeLimit){            this._error('minSizeError', name);            return false;                    }                return true;                    },    _error: function(code, fileName){        var message = this._options.messages[code];                function r(name, replacement){ message = message.replace(name, replacement); }                r('{file}', this._formatFileName(fileName));                r('{extensions}', this._options.allowedExtensions.join(', '));        r('{sizeLimit}', this._formatSize(this._options.sizeLimit));        r('{minSizeLimit}', this._formatSize(this._options.minSizeLimit));                this._options.showMessage(message);                    },    _formatFileName: function(name){        if (name.length > 33){            name = name.slice(0, 19) + '...' + name.slice(-13);            }        return name;    },    _isAllowedExtension: function(fileName){        var ext = (-1 !== fileName.indexOf('.')) ? fileName.replace(/.*[.]/, '').toLowerCase() : '';        var allowed = this._options.allowedExtensions;                if (!allowed.length){return true;}                        for (var i=0; i<allowed.length; i++){            if (allowed[i].toLowerCase() == ext){ return true;}            }                return false;    },        _formatSize: function(bytes){        var i = -1;                                            do {            bytes = bytes / 1024;            i++;          } while (bytes > 99);                return Math.max(bytes, 0.1).toFixed(1) + ['kB', 'MB', 'GB', 'TB', 'PB', 'EB'][i];              }};       /** * Class that creates upload widget with drag-and-drop and file list * @inherits _ajax_uploader.FileUploaderBasic */_ajax_uploader.FileUploader = function(o){	if (!!navigator.userAgent.match(/like Mac OS X/) || G_UPLOAD_ENABLE != 'Y')	{		return false;	}	    // call parent constructor    _ajax_uploader.FileUploaderBasic.apply(this, arguments);        // additional options        _ajax_uploader.extend(this._options, {        element: null,        // if set, will be used instead of _ajax_upload-list in template        listElement: null,                        template: //'<div class="_ajax_upload-drop-area"><span>拖拽文件到这里上传</span></div>' +                '<a href="javascript:;" class="_ajax_upload-button btn btn-default btn-normal"><i class="icon-upload-alt"></i>上传附件</a>' +                '<div class="aw-file-uploader _ajax_upload-list clearfix" id="upload-ul"></div>',        // template for one item in file list        fileTemplate: '<dl>' +        		'<dt class="upload-loading aw-icon"></dt>' +        		'<dd>' +                 '<p class="_ajax_upload-file aw-file-uploader-name"></p>' +                '<p class="_ajax_upload-size aw-text-color-999"></p>' +				'<p class="_ajax_upload-inset"><a href="javascript:;" class="_ajax_upload_delete_file" onclick="if (confirm(\'' + _t('确认删除?') + '\')) { _ajax_uploader_delete_attach(this.href, $(this).parents(\'dl\')) } return false;">' + _t('删除') + '</a> </p>' +				'</dd>' +            '</dl>',                        classes: {            // used to get elements from templates            button: '_ajax_upload-button',            drop: '_ajax_upload-drop-area',            dropActive: '_ajax_upload-drop-area-active',            list: '_ajax_upload-list',                                    file: '_ajax_upload-file',            spinner: 'upload-loading',            size: '_ajax_upload-size',            //cancel: '_ajax_upload-cancel',            // added to list item when upload completes            // used in css to hide progress spinner            success: '_ajax_upload-success',            fail: 'error',			inset:'_ajax_upload-inset'        }    });    // overwrite options with user supplied        _ajax_uploader.extend(this._options, o);           this._element = this._options.element;        $(this._element).html(this._options.template);                this._listElement = this._options.listElement || this._find(this._element, 'list');        this._classes = this._options.classes;            this._button = this._createUploadButton(this._find(this._element, 'button'));     	//this._element.getAttribute('id') ==     //this._bindCancelEvent();    //this._setupDragDrop();};function insetImages(obj){	var iframeId = document.getElementById('answer_content_ifr') ? document.getElementById('answer_content_ifr') : document.getElementById('question_detail_ifr');	var objElements = iframeId.contentWindow.document.getElementById('tinymce');	var rel = obj.parentNode.parentNode.getElementsByTagName('span')[0].getAttribute('rel');	var html = '<img src="'+rel+'"/>';	objElements.designMode="On";	if(getBrowser()=='ie'){           objElements.focus();          o=iframeId.document.selection.createRange();          o.pasteHTML(html);     }else{          objElements.focus();          var rng = iframeId.contentWindow.getSelection().getRangeAt(0);        var frg = rng.createContextualFragment(html);          rng.insertNode(frg);    } }; //获取浏览器版本  function getBrowser(){      var agentValue = window.navigator.userAgent.toLowerCase();      if(agentValue.indexOf('msie')>0){          return "ie";      }else if(agentValue.indexOf('firefox')>0){          return "ff";      }else if(agentValue.indexOf('chrome')>0){          return "chrome";      }  }  // inherit from Basic Uploader_ajax_uploader.extend(_ajax_uploader.FileUploader.prototype, _ajax_uploader.FileUploaderBasic.prototype);_ajax_uploader.extend(_ajax_uploader.FileUploader.prototype, {    /**     * Gets one of the elements listed in this._options.classes     **/    _find: function(parent, type){                                        var element = _ajax_uploader.getByClass(parent, this._options.classes[type])[0];                if (!element){            throw new Error('element not found ' + type);        }                return element;    },        _setupDragDrop: function(){        var self = this,            dropArea = this._find(this._element, 'drop');                                var dz = new _ajax_uploader.UploadDropZone({            element: dropArea,            onEnter: function(e){                _ajax_uploader.addClass(dropArea, self._classes.dropActive);                e.stopPropagation();            },            onLeave: function(e){                e.stopPropagation();            },            onLeaveNotDescendants: function(e){                _ajax_uploader.removeClass(dropArea, self._classes.dropActive);              },            onDrop: function(e){                dropArea.style.display = 'none';                _ajax_uploader.removeClass(dropArea, self._classes.dropActive);                self._uploadFileList(e.dataTransfer.files);                }        });                        dropArea.style.display = 'none';        _ajax_uploader.attach(document, 'dragenter', function(e){                 if (!dz._isValidFileDrag(e)) return;                         dropArea.style.display = 'block';                    });                         _ajax_uploader.attach(document, 'dragleave', function(e){            if (!dz._isValidFileDrag(e)) return;                                    var relatedTarget = document.elementFromPoint(e.clientX, e.clientY);            // only fire when leaving document out            if ( ! relatedTarget || relatedTarget.nodeName == "HTML"){                               dropArea.style.display = 'none';                                                        }        });                    },        _onSubmit: function(id, fileName){        _ajax_uploader.FileUploaderBasic.prototype._onSubmit.apply(this, arguments);        this._addToList(id, fileName);        // Modify by kk        $('.btn-publish-submit').addClass('disabled');    },        _onProgress: function(id, fileName, loaded, total){        _ajax_uploader.FileUploaderBasic.prototype._onProgress.apply(this, arguments);		        var item = this._getItemByFileId(id);        var size = this._find(item, 'size');        size.style.display = '';                var text;                if (loaded != total) {            //text = Math.round(loaded / total * 100) + '% from ' + this._formatSize(total);            text = Math.round(loaded / total * 100) + '%';        } else {                                               //text = this._formatSize(total);            text = this._formatSize(total);        }                _ajax_uploader.setHTML(size, text);             },        _onComplete: function(id, fileName, result) {    		        _ajax_uploader.FileUploaderBasic.prototype._onComplete.apply(this, arguments);        // mark completed        var item = this._getItemByFileId(id);                	        if (result.success) {        	if (typeof(result.delete_url) != 'undefined')        	{				_ajax_uploader.getByClass(item, '_ajax_upload_delete_file')[0].href = result.delete_url.replace(/&amp;/g, '&');				        	}        	        	if (typeof(result.thumb) != 'undefined')        	{        		$(this._find(item, 'spinner')).css('background-image','url('+result.thumb+')').attr('rel', result.thumb);				if (typeof(result.attach_id) != 'undefined'){					$('<a/>').attr('href','javascript:;').attr('onclick','insert_attach(this,'+result.attach_id+',\''+result.attach_tag+'\')').html('插入').appendTo($(this._find(item, 'inset')));				}        	}        	else if (typeof(result.class_name) != 'undefined')        	{        		_ajax_uploader.addClass(this._find(item, 'spinner'), 'upload-' + result.class_name);        	}        	else        	{        		_ajax_uploader.addClass(item, this._classes.success);          	}        } else {        	if (!/MSIE/.test(navigator.userAgent))        	{        		_ajax_uploader.getByClass(item, '_ajax_upload_delete_file')[0].style.display = 'none';        	}        	        	_ajax_uploader.addClass(this._find(item, 'spinner'), 'upload-error');        	            _ajax_uploader.addClass(item, this._classes.fail);			_ajax_uploader.getByClass(item, '_ajax_upload_delete_file')[0].style.display = 'none';        }                _ajax_uploader.removeClass(this._find(item, 'spinner'), this._classes.spinner);         // Modify by kk        $('.btn-publish-submit').removeClass('disabled');    },        _addToList: function(id, fileName){        var item = _ajax_uploader.toElement(this._options.fileTemplate);                        item.qqFileId = id;        var fileElement = this._find(item, 'file');                _ajax_uploader.setText(fileElement, this._formatFileName(fileName));        this._find(item, 'size').style.display = 'none';                 this._listElement.appendChild(item);    },        _getItemByFileId: function(id){        var item = this._listElement.firstChild;                        // there can't be txt nodes in dynamically created list        // and we can  use nextSibling        while (item){                        if (item.qqFileId == id) return item;                        item = item.nextSibling;        }              },        /**     * delegate click event for cancel link      **/    _bindCancelEvent: function(){        var self = this,            list = this._listElement;                            _ajax_uploader.attach(list, 'click', function(e){                        e = e || window.event;            var target = e.target || e.srcElement;                        if (_ajax_uploader.hasClass(target, self._classes.cancel)){                                _ajax_uploader.preventDefault(e);                               var item = target.parentNode;                self._handler.cancel(item.qqFileId);                _ajax_uploader.remove(item);            }        });    }    });    _ajax_uploader.UploadDropZone = function(o){    this._options = {        element: null,          onEnter: function(e){},        onLeave: function(e){},          // is not fired when leaving element by hovering descendants           onLeaveNotDescendants: function(e){},           onDrop: function(e){}                           };    _ajax_uploader.extend(this._options, o);         this._element = this._options.element;        this._disableDropOutside();    this._attachEvents();   };_ajax_uploader.UploadDropZone.prototype = {    _disableDropOutside: function(e){        // run only once for all instances        if (!_ajax_uploader.UploadDropZone.dropOutsideDisabled ){            _ajax_uploader.attach(document, 'dragover', function(e){                if (e.dataTransfer){                    e.dataTransfer.dropEffect = 'none';                    e.preventDefault();                 }                       });                        _ajax_uploader.UploadDropZone.dropOutsideDisabled = true;         }            },        _attachEvents: function(){        var self = this;                                        _ajax_uploader.attach(self._element, 'dragover', function(e){            if (!self._isValidFileDrag(e)) return;                        var effect = e.dataTransfer.effectAllowed;            if (effect == 'move' || effect == 'linkMove'){                e.dataTransfer.dropEffect = 'move'; // for FF (only move allowed)                } else {                                    e.dataTransfer.dropEffect = 'copy'; // for Chrome            }                                                                 e.stopPropagation();            e.preventDefault();                                                                            });                _ajax_uploader.attach(self._element, 'dragenter', function(e){            if (!self._isValidFileDrag(e)) return;                                    self._options.onEnter(e);        });                _ajax_uploader.attach(self._element, 'dragleave', function(e){            if (!self._isValidFileDrag(e)) return;                        self._options.onLeave(e);                        var relatedTarget = document.elementFromPoint(e.clientX, e.clientY);                                  // do not fire when moving a mouse over a descendant            if (_ajax_uploader.contains(this, relatedTarget)) return;                                    self._options.onLeaveNotDescendants(e);         });                        _ajax_uploader.attach(self._element, 'drop', function(e){            if (!self._isValidFileDrag(e)) return;                        e.preventDefault();            self._options.onDrop(e);        });              },        _isValidFileDrag: function(e){        var dt = e.dataTransfer,            // do not check dt.types.contains in webkit, because it crashes safari 4                        isWebkit = navigator.userAgent.indexOf("AppleWebKit") > -1;                                // dt.effectAllowed is none in Safari 5        // dt.types.contains check is for firefox                    return dt && dt.effectAllowed != 'none' &&             (dt.files || (!isWebkit && dt.types.contains && dt.types.contains('Files')));            }        }; _ajax_uploader.UploadButton = function(o) {    this._options = {        element: null,          // if set to true adds multiple attribute to file input              multiple: false,        // name attribute of file input        name: 'file',        onChange: function(input){},        hoverClass: '_ajax_upload-button-hover',        focusClass: '_ajax_upload-button-focus'                           };        _ajax_uploader.extend(this._options, o);            this._element = this._options.element;        // make button suitable container for input    _ajax_uploader.css(this._element, {        position: 'relative',        overflow: 'hidden',        // Make sure browse button is in the right side        // in Internet Explorer        direction: 'ltr'    });           this._input = this._createInput();};_ajax_uploader.UploadButton.prototype = {    /* returns file input element */        getInput: function(){        return this._input;    },    /* cleans/recreates the file input */    reset: function(){        if (this._input.parentNode){            _ajax_uploader.remove(this._input);            }                                _ajax_uploader.removeClass(this._element, this._options.focusClass);        this._input = this._createInput();    },        _createInput: function(){                        var input = document.createElement("input");                if (this._options.multiple){            input.setAttribute("multiple", "multiple");        }                        input.setAttribute("type", "file");        input.setAttribute("name", this._options.name);                _ajax_uploader.css(input, {            position: 'absolute',            // in Opera only 'browse' button            // is clickable and it is located at            // the right side of the input            right: 0,            top: 0,            fontFamily: 'Arial',            // 4 persons reported this, the max values that worked for them were 243, 236, 236, 118            fontSize: '118px',            margin: 0,            padding: 0,            cursor: 'pointer',            opacity: 0        });                this._element.appendChild(input);        var self = this;        _ajax_uploader.attach(input, 'change', function(){            self._options.onChange(input);        });                        _ajax_uploader.attach(input, 'mouseover', function(){            _ajax_uploader.addClass(self._element, self._options.hoverClass);        });        _ajax_uploader.attach(input, 'mouseout', function(){            _ajax_uploader.removeClass(self._element, self._options.hoverClass);        });        _ajax_uploader.attach(input, 'focus', function(){            _ajax_uploader.addClass(self._element, self._options.focusClass);        });        _ajax_uploader.attach(input, 'blur', function(){            _ajax_uploader.removeClass(self._element, self._options.focusClass);        });        // IE and Opera, unfortunately have 2 tab stops on file input        // which is unacceptable in our case, disable keyboard access        if (window.attachEvent){            // it is IE or Opera            input.setAttribute('tabIndex', "-1");        }        return input;                }        };/** * Class for uploading files, uploading itself is handled by child classes */_ajax_uploader.UploadHandlerAbstract = function(o){    this._options = {        debug: false,        action: G_BASE_URL+'/upload.php',        // maximum number of concurrent uploads                maxConnections: 999,        onProgress: function(id, fileName, loaded, total){},        onComplete: function(id, fileName, response){},        onCancel: function(id, fileName){}    };    _ajax_uploader.extend(this._options, o);            this._queue = [];    // params for files in queue    this._params = [];};_ajax_uploader.UploadHandlerAbstract.prototype = {    log: function(str){        if (this._options.debug && window.console) console.log('[uploader] ' + str);            },    /**     * Adds file or file input to the queue     * @returns id     **/        add: function(file){},    /**     * Sends the file identified by id and additional query params to the server     */    upload: function(id, params){        var len = this._queue.push(id);        var copy = {};                _ajax_uploader.extend(copy, params);        this._params[id] = copy;                                // if too many active uploads, wait...        if (len <= this._options.maxConnections){                           this._upload(id, this._params[id]);        }    },    /**     * Cancels file upload by id     */    cancel: function(id){        this._cancel(id);        this._dequeue(id);    },    /**     * Cancells all uploads     */    cancelAll: function(){        for (var i=0; i<this._queue.length; i++){            this._cancel(this._queue[i]);        }        this._queue = [];    },    /**     * Returns name of the file identified by id     */    getName: function(id){},    /**     * Returns size of the file identified by id     */              getSize: function(id){},    /**     * Returns id of files being uploaded or     * waiting for their turn     */    getQueue: function(){        return this._queue;    },    /**     * Actual upload method     */    _upload: function(id){},    /**     * Actual cancel method     */    _cancel: function(id){},         /**     * Removes element from queue, starts upload of next     */    _dequeue: function(id){        var i = _ajax_uploader.indexOf(this._queue, id);        this._queue.splice(i, 1);                        var max = this._options.maxConnections;                if (this._queue.length >= max && i < max){            var nextId = this._queue[max-1];            this._upload(nextId, this._params[nextId]);        }    }        };/** * Class for uploading files using form and iframe * @inherits _ajax_uploader.UploadHandlerAbstract */_ajax_uploader.UploadHandlerForm = function(o){    _ajax_uploader.UploadHandlerAbstract.apply(this, arguments);           this._inputs = {};};// @inherits _ajax_uploader.UploadHandlerAbstract_ajax_uploader.extend(_ajax_uploader.UploadHandlerForm.prototype, _ajax_uploader.UploadHandlerAbstract.prototype);_ajax_uploader.extend(_ajax_uploader.UploadHandlerForm.prototype, {    add: function(fileInput){        fileInput.setAttribute('name', 'qqfile');        var id = '_ajax_upload-handler-iframe' + _ajax_uploader.getUniqueId();                       this._inputs[id] = fileInput;                // remove file input from DOM        if (fileInput.parentNode){            _ajax_uploader.remove(fileInput);        }                        return id;    },    getName: function(id){        // get input value and remove path to normalize        return this._inputs[id].value.replace(/.*(\/|\\)/, "");    },        _cancel: function(id){        this._options.onCancel(id, this.getName(id));                delete this._inputs[id];                var iframe = document.getElementById(id);        if (iframe){            // to cancel request set src to something else            // we use src="javascript:false;" because it doesn't            // trigger ie6 prompt on https            iframe.setAttribute('src', 'javascript:false;');            _ajax_uploader.remove(iframe);        }    },         _upload: function(id, params){                                var input = this._inputs[id];                if (!input){            throw new Error('file with passed id was not added, or already uploaded or cancelled');        }                        var fileName = this.getName(id);                        var iframe = this._createIframe(id);        var form = this._createForm(iframe, params);        form.appendChild(input);        var self = this;        this._attachLoadEvent(iframe, function(){                                             self.log('iframe loaded');                        var response = self._getIframeContentJSON(iframe);            self._options.onComplete(id, fileName, response);            self._dequeue(id);                        delete self._inputs[id];            // timeout added to fix busy state in FF3.6            setTimeout(function(){                _ajax_uploader.remove(iframe);            }, 1);        });        form.submit();                _ajax_uploader.remove(form);                        return id;    },     _attachLoadEvent: function(iframe, callback){        _ajax_uploader.attach(iframe, 'load', function(){            // when we remove iframe from dom            // the request stops, but in IE load            // event fires            if (!iframe.parentNode){                return;            }            // fixing Opera 10.53            if (iframe.contentDocument &&                iframe.contentDocument.body &&                iframe.contentDocument.body.innerHTML == "false"){                // In Opera event is fired second time                // when body.innerHTML changed from false                // to server response approx. after 1 sec                // when we upload file with iframe                return;            }            callback();        });    },    /**     * Returns json object received by iframe from server.     */    _getIframeContentJSON: function(iframe){        // iframe.contentWindow.document - for IE<7        var doc = iframe.contentDocument ? iframe.contentDocument: iframe.contentWindow.document,            response;                this.log("converting iframe's innerHTML to JSON");        this.log("innerHTML = " + doc.body.innerHTML);                                try {            response = eval("(" + doc.body.innerHTML + ")");        } catch(err){            response = {};        }                return response;    },    /**     * Creates iframe with unique name     */    _createIframe: function(id){        // We can't use following code as the name attribute        // won't be properly registered in IE6, and new window        // on form submit will open        // var iframe = document.createElement('iframe');        // iframe.setAttribute('name', id);        var iframe = _ajax_uploader.toElement('<iframe src="javascript:false;" name="' + id + '" />');        // src="javascript:false;" removes ie6 prompt on https        iframe.setAttribute('id', id);        iframe.style.display = 'none';        document.body.appendChild(iframe);        return iframe;    },    /**     * Creates form, that will be submitted to iframe     */    _createForm: function(iframe, params){        // We can't use the following code in IE6        // var form = document.createElement('form');        // form.setAttribute('method', 'post');        // form.setAttribute('enctype', 'multipart/form-data');        // Because in this case file won't be attached to request        var form = _ajax_uploader.toElement('<form method="post" enctype="multipart/form-data"></form>');        var queryString = _ajax_uploader.obj2url(params, this._options.action);        form.setAttribute('action', queryString);        form.setAttribute('target', iframe.name);        form.style.display = 'none';        document.body.appendChild(form);        return form;    }});/** * Class for uploading files using xhr * @inherits _ajax_uploader.UploadHandlerAbstract */_ajax_uploader.UploadHandlerXhr = function(o){    _ajax_uploader.UploadHandlerAbstract.apply(this, arguments);    this._files = [];    this._xhrs = [];        // current loaded size in bytes for each file     this._loaded = [];};// static method_ajax_uploader.UploadHandlerXhr.isSupported = function(){    var input = document.createElement('input');    input.type = 'file';                return (        'multiple' in input &&        typeof File != "undefined" &&        typeof (new XMLHttpRequest()).upload != "undefined" );       };// @inherits _ajax_uploader.UploadHandlerAbstract_ajax_uploader.extend(_ajax_uploader.UploadHandlerXhr.prototype, _ajax_uploader.UploadHandlerAbstract.prototype)_ajax_uploader.extend(_ajax_uploader.UploadHandlerXhr.prototype, {    /**     * Adds file to the queue     * Returns id to use with upload, cancel     **/        add: function(file){        if (!(file instanceof File)){            throw new Error('Passed obj in not a File (in _ajax_uploader.UploadHandlerXhr)');        }                        return this._files.push(file) - 1;            },    getName: function(id){                var file = this._files[id];        // fix missing name in Safari 4        return file.fileName != null ? file.fileName : file.name;           },    getSize: function(id){        var file = this._files[id];        return file.fileSize != null ? file.fileSize : file.size;    },        /**     * Returns uploaded bytes for file identified by id      */        getLoaded: function(id){        return this._loaded[id] || 0;     },    /**     * Sends the file identified by id and additional query params to the server     * @param {Object} params name-value string pairs     */        _upload: function(id, params){        var file = this._files[id],            name = this.getName(id),            size = this.getSize(id);                        this._loaded[id] = 0;                                        var xhr = this._xhrs[id] = new XMLHttpRequest();        var self = this;                                                xhr.upload.onprogress = function(e){            if (e.lengthComputable){                self._loaded[id] = e.loaded;                self._options.onProgress(id, name, e.loaded, e.total);            }        };        xhr.onreadystatechange = function(){                        if (xhr.readyState == 4){                self._onComplete(id, xhr);                                }        };        // build query string        params = params || {};        params['qqfile'] = name;        var queryString = _ajax_uploader.obj2url(params, this._options.action);        xhr.open("POST", queryString, true);        xhr.setRequestHeader("X-Requested-With", "XMLHttpRequest");        xhr.setRequestHeader("X-File-Name", encodeURIComponent(name));        xhr.setRequestHeader("Content-Type", "application/octet-stream");        xhr.send(file);    },    _onComplete: function(id, xhr){        // the request was aborted/cancelled        if (!this._files[id]) return;                var name = this.getName(id);        var size = this.getSize(id);                this._options.onProgress(id, name, size, size);                        if (xhr.status == 200){            this.log("xhr - server response received");            this.log("responseText = " + xhr.responseText);                                    var response;                                try {                response = eval("(" + xhr.responseText + ")");            } catch(err){                response = {};            }                        this._options.onComplete(id, name, response);                                } else {                               this._options.onComplete(id, name, {});        }                        this._files[id] = null;        this._xhrs[id] = null;            this._dequeue(id);                        },    _cancel: function(id){        this._options.onCancel(id, this.getName(id));                this._files[id] = null;                if (this._xhrs[id]){            this._xhrs[id].abort();            this._xhrs[id] = null;                                           }    }});function _ajax_uploader_delete_attach(url, el){	var this_el = el;		$.get(url, function (result) {		if (result.errno == "-1")		{			$.alert(result.err);		}		else		{			this_el.fadeOut();			this_el.remove();		}	}, 'json');}function _ajax_uploader_append_file(selecter, v){	var url = '';		if (typeof(v['thumb']) != 'undefined')    {    	    	if (typeof(v['thumb']) != 'string')    	{    		url = v['thumb']['90x90'];    	}    	else    	{    		url = v['thumb'];    	}    }            var html = '<dl>' +        '<dt class="aw-icon upload-' + v['class_name'] + '" ' + (url==null || url=='' ? '' : 'style="background-image:url('+url+')"')+'></dt>' +        '<dd>' +         '<p class="_ajax_upload-file aw-file-uploader-name" title="' + v['file_name'] + '">' + (v['file_name']).substring(0, 10) + '...</p>' +        '<p class="_ajax_upload-inset"><a href="' + v['delete_link'] + '" class="_ajax_upload_delete_file" onclick="if (confirm(\'' + _t('确认删除?') + '\')) { _ajax_uploader_delete_attach(this.href, $(this).parents(\'dl\')) } return false;">' + _t('删除') + '</a> ';                if (typeof(v['thumb']) != 'undefined' && typeof(v['attach_id']) != 'undefined')        {	        html += '<a href="javascript:;" onclick="insert_attach(this, ' + v['attach_id'] + ',\'' + v['attach_tag'] + '\')">' + _t('插入') + '</a>';        }               html += '</p></dd></dl>';			$(selecter).append(html);}